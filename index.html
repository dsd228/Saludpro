I'll create a medical application web interface based on the detailed specifications provided in your document. Since you've requested HTML implementation (as per the file content), I'll create a standalone HTML file for "SaludPro" - an integrated clinical management system.

```html
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaludPro - Gestión Clínica</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Material+Symbols+Outlined" rel="stylesheet">
    <style>
        /* Estilos Generales y Reset */
        :root {
            --primary-blue: #1a73e8;
            --success-green: #34a853;
            --warning-yellow: #f9ab00;
            --alert-red: #ea4335;
            --background-light: #f8f9fa;
            --text-dark: #202124;
            --border-radius: 8px;
            --shadow-medium: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
            --shadow-large: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);
            --transition-fast: all 0.2s ease-in-out;
        }
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            background-color: var(--background-light);
            color: var(--text-dark);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }
        h1, h2, h3, h4, h5, h6 {
            color: var(--primary-blue);
            margin-top: 0;
        }
        a {
            color: var(--primary-blue);
            text-decoration: none;
            transition: var(--transition-fast);
        }
        a:hover {
            color: #0d47a1;
        }
        /* Header */
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 30px;
            background-color: white;
            box-shadow: var(--shadow-medium);
            border-bottom-left-radius: var(--border-radius);
            border-bottom-right-radius: var(--border-radius);
        }
        .logo-container {
            display: flex;
            align-items: center;
        }
        .app-icon {
            font-size: 2.5em;
            color: var(--primary-blue);
            margin-right: 10px;
        }
        header h1 {
            margin: 0;
            font-size: 2em;
            color: var(--primary-blue);
        }
        .subtitle {
            font-size: 1.1em;
            color: #5f6368;
            font-weight: 500;
        }
        .user-profile {
            display: flex;
            align-items: center;
        }
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
            border: 2px solid var(--primary-blue);
        }
        .user-profile span {
            font-weight: 500;
        }
        /* Navigation */
        nav {
            background-color: white;
            padding: 10px 30px;
            box-shadow: var(--shadow-medium);
            border-bottom-left-radius: var(--border-radius);
            border-bottom-right-radius: var(--border-radius);
            margin-bottom: 20px;
        }
        nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
        }
        nav ul li {
            margin: 0 15px;
        }
        nav ul li a {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            color: #5f6368;
            font-weight: 500;
            transition: var(--transition-fast);
            background-color: transparent;
        }
        nav ul li a:hover,
        nav ul li a.active {
            background-color: #e8f0fe;
            color: var(--primary-blue);
        }
        nav ul li a .material-symbols-outlined {
            margin-right: 8px;
            font-size: 1.3em;
        }
        /* Main Content Area */
        #app-content {
            flex-grow: 1;
            padding: 0 30px 30px;
            position: relative;
        }
        .page {
            display: none;
            padding: 20px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            margin-top: 20px;
            animation: fadeIn 0.5s ease-out;
        }
        .page.active {
            display: block;
        }
        /* Dashboard Specific Styles */
        .patient-selector {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background-color: var(--background-light);
            border-radius: var(--border-radius);
            border: 1px solid #e0e0e0;
        }
        .patient-selector label {
            margin-right: 15px;
            font-weight: 500;
        }
        #active-patient {
            padding: 8px 12px;
            border-radius: var(--border-radius);
            border: 1px solid #ccc;
            min-width: 200px;
            font-size: 1em;
        }
        .alert-card {
            display: flex;
            align-items: center;
            background-color: var(--warning-yellow);
            color: var(--text-dark);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow-medium);
            border-left: 5px solid var(--alert-red);
        }
        .alert-icon {
            color: var(--alert-red);
            margin-right: 15px;
            font-size: 1.5em;
        }
        .indicator-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .indicator-card {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            text-align: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .indicator-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-large);
        }
        .indicator-card .material-symbols-outlined {
            font-size: 2.5em;
            color: var(--primary-blue);
            margin-bottom: 10px;
        }
        .indicator-card h3 {
            margin: 0 0 5px 0;
            font-size: 1.2em;
            color: #5f6368;
        }
        .indicator-card p {
            font-size: 1.5em;
            font-weight: 500;
            margin: 0;
            color: var(--text-dark);
        }
        .chart-container {
            position: relative;
            padding: 20px;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            text-align: center;
        }
        .chart-container canvas {
            max-width: 100%;
            height: 300px !important;
        }
        #chart-type-selector {
            margin-top: 20px;
            padding: 8px 12px;
            border-radius: var(--border-radius);
            border: 1px solid #ccc;
            font-size: 1em;
        }
        /* Pacientes Page Styles */
        .search-filter-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background-color: var(--background-light);
            border-radius: var(--border-radius);
        }
        #patient-search, #specialty-filter {
            padding: 10px 15px;
            border-radius: var(--border-radius);
            border: 1px solid #ccc;
            flex-grow: 1;
            font-size: 1em;
        }
        #specialty-filter {
            flex-grow: 0;
        }
        .patient-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        .patient-card {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-medium);
            transition: var(--transition-fast);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .patient-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-large);
        }
        .patient-card h3 {
            margin-top: 0;
            color: var(--primary-blue);
            font-size: 1.3em;
        }
        .patient-card p {
            margin-bottom: 5px;
            font-size: 0.95em;
        }
        .patient-card strong {
            color: #3c4043;
        }
        .btn-view-history {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px 15px;
            margin-top: 15px;
            border: none;
            border-radius: var(--border-radius);
            background-color: var(--primary-blue);
            color: white;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-fast);
        }
        .btn-view-history .material-symbols-outlined {
            margin-right: 8px;
            font-size: 1.2em;
        }
        .btn-view-history:hover {
            background-color: #0d47a1;
            transform: translateY(-2px);
        }
        /* Botones generales */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition-fast);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .btn-primary {
            background-color: var(--primary-blue);
            color: white;
        }
        .btn-primary:hover {
            background-color: #0d47a1;
            transform: translateY(-2px);
        }
        .btn-secondary {
            background-color: #e8f0fe;
            color: var(--primary-blue);
            border: 1px solid var(--primary-blue);
        }
        .btn-secondary:hover {
            background-color: #cfe2ff;
            transform: translateY(-2px);
        }
        /* Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            animation: fadeInOverlay 0.3s ease-out forwards;
        }
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-large);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideIn 0.4s ease-out forwards;
            position: relative;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        .modal-header h2 {
            margin: 0;
            color: var(--text-dark);
            font-size: 1.5em;
        }
        .modal-close-btn {
            background: none;
            border: none;
            font-size: 2em;
            color: #888;
            cursor: pointer;
            padding: 0 10px;
            line-height: 1;
            transition: var(--transition-fast);
        }
        .modal-close-btn:hover {
            color: var(--alert-red);
        }
        /* Tabs dentro del modal */
        .modal-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--primary-blue);
        }
        .modal-tab {
            padding: 10px 20px;
            border: none;
            background-color: transparent;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 500;
            color: #5f6368;
            transition: var(--transition-fast);
        }
        .modal-tab.active {
            color: var(--primary-blue);
            border-bottom: 2px solid var(--primary-blue);
        }
        .modal-tab-content {
            display: none;
        }
        .modal-tab-content.active {
            display: block;
        }
        /* Estilos para tablas en modales */
        .modal-tab-content table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .modal-tab-content th,
        .modal-tab-content td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        .modal-tab-content th {
            background-color: var(--background-light);
            color: var(--text-dark);
            font-weight: 500;
        }
        .modal-tab-content tr:hover {
            background-color: #f0f0f0;
        }
        /* Animaciones */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInOverlay {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        /* Responsive adjustments */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                padding: 15px;
            }
            .subtitle {
                display: none;
            }
            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }
            nav ul li {
                margin: 5px 10px;
            }
            #app-content {
                padding: 0 15px 15px;
            }
            .patient-selector {
                flex-direction: column;
                align-items: flex-start;
            }
            .patient-selector label {
                margin-bottom: 10px;
            }
            .search-filter-bar {
                flex-direction: column;
                align-items: stretch;
            }
            #patient-search, #specialty-filter {
                width: 100%;
            }
            .modal-content {
                width: 95%;
                padding: 20px;
            }
        }
        @media (max-width: 480px) {
            header h1 {
                font-size: 1.5em;
            }
            .user-profile span {
                font-size: 0.9em;
            }
            nav ul li a {
                font-size: 0.9em;
                padding: 8px 12px;
            }
            .indicator-cards {
                grid-template-columns: 1fr;
            }
            .alert-card {
                flex-direction: column;
                text-align: center;
            }
            .alert-icon {
                margin-bottom: 10px;
            }
            .patient-card {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo-container">
            <span class="material-symbols-outlined app-icon">local_hospital</span>
            <h1>SaludPro</h1>
        </div>
        <div class="subtitle">Sistema Integral de Gestión Clínica</div>
        <div class="user-profile">
            <img src="https://placehold.co/40x40/1a73e8/ffffff?text=JP" alt="Avatar del médico" class="avatar">
            <span>Dr. Juan Pérez</span>
        </div>
    </header>
    <nav>
        <ul>
            <li><a href="#dashboard" data-section="dashboard"><span class="material-symbols-outlined">dashboard</span> Dashboard</a></li>
            <li><a href="#pacientes" data-section="pacientes"><span class="material-symbols-outlined">people</span> Pacientes</a></li>
            <li><a href="#signos-vitales" data-section="signos-vitales"><span class="material-symbols-outlined">monitor_heart</span> Signos Vitales</a></li>
            <li><a href="#recetas" data-section="recetas"><span class="material-symbols-outlined">medication</span> Recetas</a></li>
            <li><a href="#educacion" data-section="educacion"><span class="material-symbols-outlined">school</span> Educación</a></li>
            <li><a href="#calculadoras" data-section="calculadoras"><span class="material-symbols-outlined">calculate</span> Calculadoras</a></li>
        </ul>
    </nav>
    <main id="app-content">
        <!-- Dashboard -->
        <section id="dashboard" class="page active">
            <h2>Dashboard</h2>
            <p>Bienvenido, Dr. Juan Pérez.</p>
            <div class="patient-selector">
                <label for="active-patient">Paciente Activo:</label>
                <select id="active-patient">
                    <option value="">Selecciona un paciente...</option>
                </select>
            </div>
            <div class="alert-card">
                <span class="material-symbols-outlined alert-icon">warning</span>
                Seguimiento pendiente: Paciente Ana García con VIH requiere control.
            </div>
            <div class="indicator-cards">
                <div class="indicator-card">
                    <span class="material-symbols-outlined">trending_up</span>
                    <h3>CD4</h3>
                    <p>500 cel/µL</p>
                </div>
                <div class="indicator-card">
                    <span class="material-symbols-outlined">analytics</span>
                    <h3>Carga Viral</h3>
                    <p>Indetectable</p>
                </div>
                <div class="indicator-card">
                    <span class="material-symbols-outlined">fitness_center</span>
                    <h3>IMC</h3>
                    <p>24.5</p>
                </div>
                <div class="indicator-card">
                    <span class="material-symbols-outlined">blood_pressure</span>
                    <h3>PA</h3>
                    <p>120/80 mmHg</p>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="vitalSignsChart"></canvas>
                <select id="chart-type-selector">
                    <option value="pressure">Presión Arterial</option>
                    <option value="heartRate">Frecuencia Cardíaca</option>
                    <option value="temperature">Temperatura</option>
                </select>
            </div>
        </section>
        
        <!-- Gestión de Pacientes -->
        <section id="pacientes" class="page">
            <h2>Gestión de Pacientes</h2>
            <div class="search-filter-bar">
                <input type="text" id="patient-search" placeholder="Buscar paciente por nombre o diagnóstico...">
                <select id="specialty-filter">
                    <option value="">Filtrar por especialidad...</option>
                </select>
                <button class="btn btn-primary btn-add-patient"><span class="material-symbols-outlined">add</span> Nuevo Paciente</button>
            </div>
            <div id="patient-grid" class="patient-grid">
                <!-- Tarjetas de pacientes se cargarán aquí -->
            </div>
        </section>
        
        <!-- Signos Vitales -->
        <section id="signos-vitales" class="page">
            <h2>Registro de Signos Vitales</h2>
            <div class="patient-selector">
                <label for="vitals-patient">Paciente:</label>
                <select id="vitals-patient">
                    <option value="">Selecciona un paciente...</option>
                </select>
            </div>
            <div class="form-container">
                <div class="form-row">
                    <div class="form-group">
                        <label for="temperature">Temperatura (°C)</label>
                        <input type="number" id="temperature" step="0.1" placeholder="36.5">
                    </div>
                    <div class="form-group">
                        <label for="pa">Presión Arterial (mmHg)</label>
                        <input type="text" id="pa" placeholder="120/80">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="fc">Frecuencia Cardíaca (ppm)</label>
                        <input type="number" id="fc" placeholder="75">
                    </div>
                    <div class="form-group">
                        <label for="fr">Frecuencia Respiratoria (rpm)</label>
                        <input type="number" id="fr" placeholder="16">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="spo2">Saturación O2 (%)</label>
                        <input type="number" id="spo2" placeholder="98">
                    </div>
                    <div class="form-group">
                        <label for="weight">Peso (kg)</label>
                        <input type="number" id="weight" step="0.1" placeholder="70">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="height">Talla (cm)</label>
                        <input type="number" id="height" placeholder="165">
                    </div>
                    <div class="form-group">
                        <label for="imc">IMC</label>
                        <input type="text" id="imc" readonly placeholder="Calculado automáticamente">
                    </div>
                </div>
                <div class="form-group">
                    <label for="notes">Notas adicionales</label>
                    <textarea id="notes" rows="3" placeholder="Observaciones del paciente..."></textarea>
                </div>
                <button class="btn btn-primary" id="save-vitals">Guardar Signos Vitales</button>
            </div>
        </section>
        
        <!-- Recetas -->
        <section id="recetas" class="page">
            <h2>Emisión de Recetas</h2>
            <div class="patient-selector">
                <label for="recipe-patient">Paciente:</label>
                <select id="recipe-patient">
                    <option value="">Selecciona un paciente...</option>
                </select>
            </div>
            <div class="medication-list">
                <h3>Medicamentos</h3>
                <div id="medication-entries">
                    <div class="medication-entry">
                        <div class="form-row">
                            <div class="form-group flex-grow">
                                <label for="medication-1">Medicamento</label>
                                <input type="text" id="medication-1" class="medication-name" placeholder="Nombre del medicamento">
                            </div>
                            <div class="form-group">
                                <label for="dose-1">Dosis</label>
                                <input type="text" id="dose-1" placeholder="10mg">
                            </div>
                            <div class="form-group">
                                <label for="frequency-1">Frecuencia</label>
                                <select id="frequency-1">
                                    <option value="once">1 vez al día</option>
                                    <option value="twice">2 veces al día</option>
                                    <option value="thrice">3 veces al día</option>
                                    <option value="four-times">4 veces al día</option>
                                    <option value="as-needed">Según necesidad</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="duration-1">Duración</label>
                                <input type="text" id="duration-1" placeholder="7 días">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="instructions-1">Instrucciones</label>
                            <textarea id="instructions-1" rows="2" placeholder="Tomar después de las comidas..."></textarea>
                        </div>
                    </div>
                </div>
                <button class="btn btn-secondary" id="add-medication"><span class="material-symbols-outlined">add</span> Añadir Medicamento</button>
            </div>
            <div class="interactions-warning" id="interactions-warning" style="display: none;">
                <span class="material-symbols-outlined alert-icon">dangerous</span>
                <div>
                    <strong>Interacciones Medicamentosas Detectadas</strong>
                    <p id="interactions-list"></p>
                </div>
            </div>
            <div class="form-group">
                <label for="prescription-notes">Notas para el paciente</label>
                <textarea id="prescription-notes" rows="3" placeholder="Información adicional para el paciente..."></textarea>
            </div>
            <button class="btn btn-primary" id="issue-prescription">Emitir Receta</button>
        </section>
        
        <!-- Educación Médica -->
        <section id="educacion" class="page">
            <h2>Recursos de Educación Médica</h2>
            <div class="resource-cards">
                <div class="resource-card">
                    <h3>Guías Clínicas</h3>
                    <p>Accede a las guías clínicas más recientes y actualizadas.</p>
                    <ul>
                        <li><a href="#">Hipertensión Arterial - 2023</a></li>
                        <li><a href="#">Diabetes Mellitus - 2023</a></li>
                        <li><a href="#">Enfermedad Pulmonar Obstructiva Crónica</a></li>
                        <li><a href="#">VIH/SIDA - Manejo Integral</a></li>
                    </ul>
                </div>
                <div class="resource-card">
                    <h3>Artículos Científicos</h3>
                    <p>Revisa los últimos estudios y publicaciones científicas.</p>
                    <ul>
                        <li><a href="#">Avances en inmunoterapia oncológica</a></li>
                        <li><a href="#">Nuevos fármacos para enfermedades cardiovasculares</a></li>
                        <li><a href="#">Tratamientos innovadores para enfermedades neurodegenerativas</a></li>
                        <li><a href="#">Medicina de precisión en oncología</a></li>
                    </ul>
                </div>
                <div class="resource-card">
                    <h3>Educación al Paciente</h3>
                    <p>Materiales educativos para compartir con tus pacientes.</p>
                    <ul>
                        <li><a href="#">Cómo controlar tu diabetes</a></li>
                        <li><a href="#">Ejercicios para pacientes con artrosis</a></li>
                        <li><a href="#">Alimentación saludable para hipertensos</a></li>
                        <li><a href="#">Manejo del estrés y ansiedad</a></li>
                    </ul>
                </div>
            </div>
        </section>
        
        <!-- Calculadoras Médicas -->
        <section id="calculadoras" class="page">
            <h2>Calculadoras Clínicas</h2>
            <div class="calculator-selector">
                <label for="calc-selector">Selecciona una calculadora:</label>
                <select id="calc-selector">
                    <option value="imc">Índice de Masa Corporal (IMC)</option>
                    <option value="filtration">Filtrado Glomerular (CKD-EPI)</option>
                    <option value="child-pugh">Child-Pugh</option>
                    <option value="apgar">Apgar</option>
                    <option value="gestational-age">Edad Gestacional</option>
                </select>
            </div>
            
            <!-- Calculadora de IMC -->
            <div class="calculator-form" id="imc-calculator">
                <h3>Calculadora de Índice de Masa Corporal (IMC)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="imc-weight">Peso (kg)</label>
                        <input type="number" id="imc-weight" step="0.1" placeholder="70">
                    </div>
                    <div class="form-group">
                        <label for="imc-height">Talla (cm)</label>
                        <input type="number" id="imc-height" placeholder="170">
                    </div>
                </div>
                <button class="btn btn-primary" id="calculate-imc">Calcular IMC</button>
                <div class="result-display" id="imc-result" style="display: none;">
                    <h4>Resultado</h4>
                    <p><strong>IMC:</strong> <span id="imc-value"></span></p>
                    <p><strong>Clasificación:</strong> <span id="imc-classification"></span></p>
                </div>
            </div>
            
            <!-- Calculadora de Filtrado Glomerular -->
            <div class="calculator-form" id="filtration-calculator" style="display: none;">
                <h3>Calculadora de Filtrado Glomerular (CKD-EPI)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="creatinine">Creatinina sérica (mg/dL)</label>
                        <input type="number" id="creatinine" step="0.1" placeholder="1.0">
                    </div>
                    <div class="form-group">
                        <label for="age">Edad (años)</label>
                        <input type="number" id="age" placeholder="45">
                    </div>
                </div>
                <div class="form-group">
                    <label>Sexo</label>
                    <div class="radio-group">
                        <label><input type="radio" name="gender" value="male" checked> Masculino</label>
                        <label><input type="radio" name="gender" value="female"> Femenino</label>
                    </div>
                </div>
                <button class="btn btn-primary" id="calculate-filtration">Calcular TFG</button>
                <div class="result-display" id="filtration-result" style="display: none;">
                    <h4>Resultado</h4>
                    <p><strong>Filtrado Glomerular:</strong> <span id="filtration-value"></span> ml/min/1.73m²</p>
                    <p><strong>Estadio de Enfermedad Renal:</strong> <span id="filtration-stage"></span></p>
                </div>
            </div>
            
            <!-- Calculadora Child-Pugh -->
            <div class="calculator-form" id="child-pugh-calculator" style="display: none;">
                <h3>Calculadora Child-Pugh</h3>
                <table class="child-pugh-table">
                    <thead>
                        <tr>
                            <th>Parámetro</th>
                            <th>1 Punto</th>
                            <th>2 Puntos</th>
                            <th>3 Puntos</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Ascitis</td>
                            <td>Ausente</td>
                            <td>Leve/Moderada</td>
                            <td>Refractaria</td>
                        </tr>
                        <tr>
                            <td>Encefalopatía</td>
                            <td>Grado 0-1</td>
                            <td>Grado 2</td>
                            <td>Grado 3-4</td>
                        </tr>
                        <tr>
                            <td>Bilirrubina (mg/dL)</td>
                            <td>&lt; 2.0</td>
                            <td>2.0-3.0</td>
                            <td>&gt; 3.0</td>
                        </tr>
                        <tr>
                            <td>Albúmina (g/dL)</td>
                            <td>&gt; 3.5</td>
                            <td>2.8-3.5</td>
                            <td>&lt; 2.8</td>
                        </tr>
                        <tr>
                            <td>INR</td>
                            <td>&lt; 1.7</td>
                            <td>1.7-2.3</td>
                            <td>&gt; 2.3</td>
                        </tr>
                    </tbody>
                </table>
                <div class="form-group">
                    <label for="ascites">Ascitis</label>
                    <select id="ascites">
                        <option value="1">Ausente (1 punto)</option>
                        <option value="2">Leve/Moderada (2 puntos)</option>
                        <option value="3">Refractaria (3 puntos)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="encephalopathy">Encefalopatía</label>
                    <select id="encephalopathy">
                        <option value="1">Grado 0-1 (1 punto)</option>
                        <option value="2">Grado 2 (2 puntos)</option>
                        <option value="3">Grado 3-4 (3 puntos)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="bilirubin">Bilirrubina (mg/dL)</label>
                    <select id="bilirubin">
                        <option value="1">&lt; 2.0 (1 punto)</option>
                        <option value="2">2.0-3.0 (2 puntos)</option>
                        <option value="3">&gt; 3.0 (3 puntos)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="albumin">Albúmina (g/dL)</label>
                    <select id="albumin">
                        <option value="1">&gt; 3.5 (1 punto)</option>
                        <option value="2">2.8-3.5 (2 puntos)</option>
                        <option value="3">&lt; 2.8 (3 puntos)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="inr">INR</label>
                    <select id="inr">
                        <option value="1">&lt; 1.7 (1 punto)</option>
                        <option value="2">1.7-2.3 (2 puntos)</option>
                        <option value="3">&gt; 2.3 (3 puntos)</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="calculate-child-pugh">Calcular Puntuación</button>
                <div class="result-display" id="child-pugh-result" style="display: none;">
                    <h4>Resultado</h4>
                    <p><strong>Puntuación total:</strong> <span id="child-pugh-score"></span> puntos</p>
                    <p><strong>Clasificación:</strong> <span id="child-pugh-class"></span></p>
                    <p><strong>Prognóstico medio de supervivencia:</strong> <span id="child-pugh-prognosis"></span></p>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Paneles Modales -->
    <div id="modal-overlay" class="modal-overlay">
        <div id="modal-content" class="modal-content">
            <!-- El contenido del modal se cargará aquí -->
        </div>
    </div>

    <script>
        // Datos simulados de pacientes
        const simulatedPatients = [
            {
                id: 1,
                nombre: "Ana García",
                edad: 45,
                diagnosticoPrincipal: "Hipertensión Arterial",
                especialidad: "Cardiología",
                historiaClinica: {
                    resumen: "Paciente femenina de 45 años con HTA controlada desde hace 2 años. Actualmente en tratamiento con Losartán.",
                    diagnosticos: [
                        { fecha: "2023-01-15", cie10: "I10", descripcion: "Hipertensión esencial (primaria)", estado: "Activo" },
                        { fecha: "2023-03-20", cie10: "E78.0", descripcion: "Hipercolesterolemia", estado: "Activo" }
                    ],
                    tratamientos: ["Losartán 50mg cada 12h", "Atorvastatina 20mg cada 24h"],
                    evolucion: [
                        { fecha: "2023-01-15", nota: "Primer diagnóstico de HTA. Iniciado tratamiento con Losartán." },
                        { fecha: "2023-03-20", nota: "Control de PA satisfactorio. Se agrega Atorvastatina por perfil lipídico alterado." },
                        { fecha: "2023-06-20", nota: "PA 120/80 mmHg. Perfil lipídico mejorado." }
                    ]
                },
                signosVitales: [
                    { fecha: "2023-01-15", temperatura: 36.8, pa: "130/85", fc: 75, fr: 16, spo2: 98, peso: 70, talla: 1.65 },
                    { fecha: "2023-03-20", temperatura: 36.7, pa: "125/82", fc: 72, fr: 15, spo2: 99, peso: 69, talla: 1.65 },
                    { fecha: "2023-06-20", temperatura: 36.7, pa: "120/80", fc: 70, fr: 15, spo2: 99, peso: 69, talla: 1.65 }
                ]
            },
            {
                id: 2,
                nombre: "Carlos Martínez",
                edad: 52,
                diagnosticoPrincipal: "Diabetes Mellitus Tipo 2",
                especialidad: "Endocrinología",
                historiaClinica: {
                    resumen: "Paciente masculino de 52 años con DM2 diagnosticada hace 5 años. Control metabólico subóptimo.",
                    diagnosticos: [
                        { fecha: "2018-05-10", cie10: "E11.9", descripcion: "Diabetes mellitus tipo 2 sin complicaciones", estado: "Activo" },
                        { fecha: "2022-11-03", cie10: "I25.10", descripcion: "Enfermedad arterial coronaria", estado: "Activo" }
                    ],
                    tratamientos: ["Metformina 850mg cada 12h", "Glibenclamida 5mg cada 24h", "Aspirina 100mg cada 24h"],
                    evolucion: [
                        { fecha: "2018-05-10", nota: "Diagnóstico de DM2. Iniciado tratamiento con Metformina." },
                        { fecha: "2020-02-15", nota: "HbA1c 8.5%. Se agrega Glibenclamida." },
                        { fecha: "2022-11-03", nota: "Angioplastia coronaria por angina inestable. Iniciado tratamiento con Aspirina." }
                    ]
                },
                signosVitales: [
                    { fecha: "2023-02-10", temperatura: 36.6, pa: "140/90", fc: 78, fr: 16, spo2: 97, peso: 85, talla: 1.75 },
                    { fecha: "2023-05-15", temperatura: 36.5, pa: "135/85", fc: 76, fr: 15, spo2: 98, peso: 83, talla: 1.75 },
                    { fecha: "2023-08-20", temperatura: 36.7, pa: "130/80", fc: 74, fr: 15, spo2: 99, peso: 82, talla: 1.75 }
                ]
            },
            {
                id: 3,
                nombre: "María López",
                edad: 38,
                diagnosticoPrincipal: "VIH",
                especialidad: "Infectología",
                historiaClinica: {
                    resumen: "Paciente femenina de 38 años con VIH diagnosticado hace 8 años. En terapia antirretroviral con buena adherencia.",
                    diagnosticos: [
                        { fecha: "2015-07-22", cie10: "B20", descripcion: "VIH con manifestaciones clínicas", estado: "Activo" },
                        { fecha: "2021-03-18", cie10: "Z79.899", descripcion: "Terapia de mantenimiento con antirretrovirales", estado: "Activo" }
                    ],
                    tratamientos: ["Tenofovir/Emtricitabina/Efavirenz 300/200/600mg cada 24h"],
                    evolucion: [
                        { fecha: "2015-07-22", nota: "Diagnóstico de VIH. Iniciado TARV con buen control inmunológico." },
                        { fecha: "2020-01-10", nota: "Cambio de esquema por efectos secundarios." },
                        { fecha: "2023-04-05", nota: "Carga viral indetectable desde hace 3 años. CD4 estable en 500-600 cel/µL." }
                    ]
                },
                signosVitales: [
                    { fecha: "2023-01-10", temperatura: 36.8, pa: "115/75", fc: 72, fr: 14, spo2: 98, peso: 62, talla: 1.60 },
                    { fecha: "2023-04-05", temperatura: 36.7, pa: "118/78", fc: 70, fr: 14, spo2: 99, peso: 63, talla: 1.60 },
                    { fecha: "2023-07-12", temperatura: 36.6, pa: "116/76", fc: 71, fr: 14, spo2: 98, peso: 62, talla: 1.60 }
                ]
            },
            {
                id: 4,
                nombre: "Roberto Sánchez",
                edad: 67,
                diagnosticoPrincipal: "Insuficiencia Cardíaca",
                especialidad: "Cardiología",
                historiaClinica: {
                    resumen: "Paciente masculino de 67 años con IC por miocardiopatía isquémica. Clase funcional II NYHA.",
                    diagnosticos: [
                        { fecha: "2019-09-05", cie10: "I50.9", descripcion: "Insuficiencia cardíaca no especificada", estado: "Activo" },
                        { fecha: "2019-09-05", cie10: "I25.5", descripcion: "Miocardiopatía isquémica", estado: "Activo" }
                    ],
                    tratamientos: ["Enalapril 10mg cada 12h", "Carvedilol 12.5mg cada 12h", "Espironolactona 25mg cada 24h", "Furosemida 40mg cada 24h"],
                    evolucion: [
                        { fecha: "2019-09-05", nota: "Diagnóstico de IC tras infarto de miocardio. Iniciado tratamiento farmacológico." },
                        { fecha: "2021-06-18", nota: "Optimizado tratamiento. Clase funcional II NYHA." },
                        { fecha: "2023-03-22", nota: "Estable con tratamiento actual. Control de peso y PA adecuado." }
                    ]
                },
                signosVitales: [
                    { fecha: "2023-02-08", temperatura: 36.5, pa: "125/80", fc: 68, fr: 16, spo2: 96, peso: 78, talla: 1.72 },
                    { fecha: "2023-05-11", temperatura: 36.6, pa: "122/78", fc: 66, fr: 15, spo2: 97, peso: 77, talla: 1.72 },
                    { fecha: "2023-08-15", temperatura: 36.4, pa: "120/75", fc: 65, fr: 15, spo2: 98, peso: 77, talla: 1.72 }
                ]
            }
        ];

        // Datos simulados de medicamentos e interacciones
        const medicamentosDB = {
            "Losartán": {
                nombre: "Losartán",
                interacciones: {
                    "Aspirina": { severidad: "leve", descripcion: "Puede aumentar levemente el riesgo de sangrado." },
                    "Furosemida": { severidad: "moderada", descripcion: "Puede potenciar el efecto hipotensor." }
                }
            },
            "Aspirina": {
                nombre: "Aspirina",
                interacciones: {
                    "Losartán": { severidad: "leve", descripcion: "Puede aumentar levemente el riesgo de sangrado." },
                    "Warfarina": { severidad: "fatal", descripcion: "Riesgo muy alto de hemorragia grave." },
                    "Metformina": { severidad: "leve", descripcion: "No hay interacción significativa, pero ambos pueden causar molestias gastrointestinales." }
                }
            },
            "Metformina": {
                nombre: "Metformina",
                interacciones: {
                    "Aspirina": { severidad: "leve", descripcion: "No hay interacción significativa, pero ambos pueden causar molestias gastrointestinales." },
                    "Glibenclamida": { severidad: "moderada", descripcion: "Aumenta el riesgo de hipoglucemia." }
                }
            },
            "Glibenclamida": {
                nombre: "Glibenclamida",
                interacciones: {
                    "Metformina": { severidad: "moderada", descripcion: "Aumenta el riesgo de hipoglucemia." }
                }
            },
            "Warfarina": {
                nombre: "Warfarina",
                interacciones: {
                    "Aspirina": { severidad: "fatal", descripcion: "Riesgo muy alto de hemorragia grave." },
                    "Ibuprofeno": { severidad: "moderada", descripcion: "Aumenta el riesgo de sangrado gastrointestinal." }
                }
            },
            "Tenofovir": {
                nombre: "Tenofovir",
                interacciones: {
                    "Atazanavir": { severidad: "moderada", descripcion: "Aumenta las concentraciones de tenofovir, riesgo de nefrotoxicidad." }
                }
            }
        };

        // Mock de usuario logueado
        const currentUser = {
            nombre: "Dr. Juan Pérez",
            avatar: "https://placehold.co/40x40/1a73e8/ffffff?text=JP"
        };

        // --- Lógica de la aplicación ---
        document.addEventListener('DOMContentLoaded', () => {
            // Mostrar dashboard por defecto
            showSection('dashboard');
            loadPatientsIntoSelectors();
            renderPatientGrid();
            loadSpecialties();
            
            // Inicializar calculadoras
            setupCalculators();
            
            // Inicializar signos vitales
            setupVitalSigns();
            
            // Inicializar recetas
            setupPrescriptions();
        });

        // Navegación entre secciones
        document.querySelectorAll('nav a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const sectionId = link.getAttribute('data-section');
                showSection(sectionId);
            });
        });

        function showSection(sectionId) {
            document.querySelectorAll('.page').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            // Ocultar todas las calculadoras y mostrar la predeterminada si es la sección de calculadoras
            if (sectionId === 'calculadoras') {
                document.querySelectorAll('.calculator-form').forEach(form => {
                    form.style.display = 'none';
                });
                document.getElementById('imc-calculator').style.display = 'block';
            }
        }

        function loadPatientsIntoSelectors() {
            const selector = document.getElementById('active-patient');
            const vitalsSelector = document.getElementById('vitals-patient');
            const recipeSelector = document.getElementById('recipe-patient');
            
            [selector, vitalsSelector, recipeSelector].forEach(sel => {
                if (sel) {
                    sel.innerHTML = '<option value="">Selecciona un paciente...</option>';
                    simulatedPatients.forEach(patient => {
                        const option = document.createElement('option');
                        option.value = patient.id;
                        option.textContent = `${patient.nombre} (${patient.diagnosticoPrincipal})`;
                        sel.appendChild(option);
                    });
                }
            });
        }

        function renderPatientGrid() {
            const grid = document.getElementById('patient-grid');
            grid.innerHTML = '';
            
            simulatedPatients.forEach(patient => {
                const card = document.createElement('div');
                card.className = 'patient-card';
                card.innerHTML = `
                    <h3>${patient.nombre}</h3>
                    <p><strong>Edad:</strong> ${patient.edad}</p>
                    <p><strong>Diagnóstico Principal:</strong> ${patient.diagnosticoPrincipal}</p>
                    <p><strong>Especialidad:</strong> ${patient.especialidad}</p>
                    <button class="btn btn-secondary btn-view-history" data-patient-id="${patient.id}">
                        <span class="material-symbols-outlined">history</span> Ver Historia Completa
                    </button>
                `;
                grid.appendChild(card);
            });
            
            // Añadir event listeners a los botones de "Ver Historia"
            document.querySelectorAll('.btn-view-history').forEach(button => {
                button.addEventListener('click', handleViewHistory);
            });
        }

        function handleViewHistory(event) {
            const patientId = parseInt(event.currentTarget.getAttribute('data-patient-id'));
            const patient = simulatedPatients.find(p => p.id === patientId);
            if (patient) {
                showModal('Historia Clínica', generateHistoryModalContent(patient));
            }
        }

        function generateHistoryModalContent(patient) {
            return `
                <div class="modal-header">
                    <h2>${patient.nombre}</h2>
                    <button class="modal-close-btn" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-tabs">
                    <button class="modal-tab active" data-tab="resumen">Resumen</button>
                    <button class="modal-tab" data-tab="diagnosticos">Diagnósticos</button>
                    <button class="modal-tab" data-tab="tratamientos">Tratamientos</button>
                    <button class="modal-tab" data-tab="evolucion">Evolución</button>
                </div>
                <div class="modal-tab-content active" data-tab-pane="resumen">
                    <p><strong>Edad:</strong> ${patient.edad}</p>
                    <p><strong>Diagnóstico Principal:</strong> ${patient.diagnosticoPrincipal}</p>
                    <p><strong>Especialidad:</strong> ${patient.especialidad}</p>
                    <p><strong>Información básica:</strong> ${patient.historiaClinica.resumen}</p>
                </div>
                <div class="modal-tab-content" data-tab-pane="diagnosticos">
                    <table>
                        <thead>
                            <tr><th>Fecha</th><th>Código CIE-10</th><th>Descripción</th><th>Estado</th></tr>
                        </thead>
                        <tbody>
                            ${patient.historiaClinica.diagnosticos.map(diag => `
                                <tr>
                                    <td>${diag.fecha}</td>
                                    <td>${diag.cie10}</td>
                                    <td>${diag.descripcion}</td>
                                    <td>${diag.estado}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
                <div class="modal-tab-content" data-tab-pane="tratamientos">
                    <ul>
                        ${patient.historiaClinica.tratamientos.map(trat => `<li>${trat}</li>`).join('')}
                    </ul>
                </div>
                <div class="modal-tab-content" data-tab-pane="evolucion">
                    <ul>
                        ${patient.historiaClinica.evolucion.map(evol => `<li><strong>${evol.fecha}:</strong> ${evol.nota}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        function showModal(title, content) {
            const modalContent = document.getElementById('modal-content');
            modalContent.innerHTML = content;
            document.getElementById('modal-overlay').style.display = 'flex';
            document.body.classList.add('modal-open');
            
            // Activar la primera pestaña del modal
            const firstTabButton = modalContent.querySelector('.modal-tab');
            if (firstTabButton) firstTabButton.click();
        }

        function closeModal() {
            document.getElementById('modal-overlay').style.display = 'none';
            document.body.classList.remove('modal-open');
        }

        // Lógica para el selector de pacientes activos
        document.getElementById('active-patient')?.addEventListener('change', (e) => {
            const selectedPatientId = parseInt(e.target.value);
            if (selectedPatientId) {
                const patient = simulatedPatients.find(p => p.id === selectedPatientId);
                console.log(`Paciente activo seleccionado: ${patient.nombre}`);
                // Aquí podrías actualizar el dashboard con datos del paciente seleccionado
            }
        });

        // Lógica básica para el botón "Agregar nuevo paciente"
        document.querySelector('.btn-add-patient')?.addEventListener('click', () => {
            alert("Funcionalidad para agregar nuevo paciente aún no implementada.");
        });

        // Manejo de pestañas en modales
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-tab')) {
                const tabId = e.target.getAttribute('data-tab');
                const modalContent = e.target.closest('.modal-content');
                modalContent.querySelectorAll('.modal-tab').forEach(tab => tab.classList.remove('active'));
                modalContent.querySelectorAll('.modal-tab-content').forEach(content => content.classList.remove('active'));
                e.target.classList.add('active');
                modalContent.querySelector(`.modal-tab-content[data-tab-pane="${tabId}"]`).classList.add('active');
            }
            
            // Cerrar modal al hacer clic fuera del contenido
            if (e.target.id === 'modal-overlay') {
                closeModal();
            }
        });

        // --- Calculadoras Médicas ---
        function setupCalculators() {
            // Selector de calculadoras
            document.getElementById('calc-selector')?.addEventListener('change', (e) => {
                const calculatorId = e.target.value + '-calculator';
                document.querySelectorAll('.calculator-form').forEach(form => {
                    form.style.display = 'none';
                });
                document.getElementById(calculatorId).style.display = 'block';
            });

            // Calculadora de IMC
            document.getElementById('calculate-imc')?.addEventListener('click', () => {
                const weight = parseFloat(document.getElementById('imc-weight').value);
                const height = parseFloat(document.getElementById('imc-height').value) / 100;
                
                if (weight > 0 && height > 0) {
                    const imc = weight / (height * height);
                    const imcValue = imc.toFixed(2);
                    
                    let classification = '';
                    if (imc < 18.5) {
                        classification = 'Bajo peso';
                    } else if (imc < 25) {
                        classification = 'Peso normal';
                    } else if (imc < 30) {
                        classification = 'Sobrepeso';
                    } else if (imc < 35) {
                        classification = 'Obesidad grado I';
                    } else if (imc < 40) {
                        classification = 'Obesidad grado II';
                    } else {
                        classification = 'Obesidad grado III (mórbida)';
                    }
                    
                    document.getElementById('imc-value').textContent = imcValue;
                    document.getElementById('imc-classification').textContent = classification;
                    document.getElementById('imc-result').style.display = 'block';
                } else {
                    alert('Por favor, ingrese valores válidos de peso y talla.');
                }
            });

            // Calculadora de Filtrado Glomerular (CKD-EPI)
            document.getElementById('calculate-filtration')?.addEventListener('click', () => {
                const creatinine = parseFloat(document.getElementById('creatinine').value);
                const age = parseInt(document.getElementById('age').value);
                const gender = document.querySelector('input[name="gender"]:checked').value;
                
                if (creatinine > 0 && age > 0) {
                    // Fórmula CKD-EPI
                    let k, a, sex_factor;
                    if (gender === 'female') {
                        k = 0.7;
                        a = creatinine <= 0.7 ? -0.241 : -1.2;
                        sex_factor = 1.018;
                    } else {
                        k = 0.9;
                        a = creatinine <= 0.9 ? -0.302 : -1.2;
                        sex_factor = 1;
                    }
                    
                    const egfr = 141 * Math.pow(Math.min(creatinine/k, 1), a) * 
                                 Math.pow(Math.max(creatinine/k, 1), -1.209) * 
                                 Math.pow(0.993, age) * sex_factor;
                    
                    const egfrValue = Math.round(egfr);
                    
                    let stage = '';
                    if (egfr >= 90) {
                        stage = 'Estadio 1: Daño renal con filtrado normal';
                    } else if (egfr >= 60) {
                        stage = 'Estadio 2: Daño renal con filtrado ligeramente disminuido';
                    } else if (egfr >= 30) {
                        stage = 'Estadio 3: Filtrado moderadamente disminuido';
                    } else if (egfr >= 15) {
                        stage = 'Estadio 4: Filtrado severamente disminuido';
                    } else {
                        stage = 'Estadio 5: Insuficiencia renal';
                    }
                    
                    document.getElementById('filtration-value').textContent = egfrValue;
                    document.getElementById('filtration-stage').textContent = stage;
                    document.getElementById('filtration-result').style.display = 'block';
                } else {
                    alert('Por favor, ingrese valores válidos de creatinina y edad.');
                }
            });

            // Calculadora Child-Pugh
            document.getElementById('calculate-child-pugh')?.addEventListener('click', () => {
                const ascites = parseInt(document.getElementById('ascites').value);
                const encephalopathy = parseInt(document.getElementById('encephalopathy').value);
                const bilirubin = parseInt(document.getElementById('bilirubin').value);
                const albumin = parseInt(document.getElementById('albumin').value);
                const inr = parseInt(document.getElementById('inr').value);
                
                const totalScore = ascites + encephalopathy + bilirubin + albumin + inr;
                
                let classification = '';
                let prognosis = '';
                
                if (totalScore <= 6) {
                    classification = 'Clase A (7-8 puntos)';
                    prognosis = '6 meses a 2 años';
                } else if (totalScore <= 9) {
                    classification = 'Clase B (9-10 puntos)';
                    prognosis = '4-6 meses';
                } else {
                    classification = 'Clase C (11-15 puntos)';
                    prognosis = '1-3 meses';
                }
                
                document.getElementById('child-pugh-score').textContent = totalScore;
                document.getElementById('child-pugh-class').textContent = classification;
                document.getElementById('child-pugh-prognosis').textContent = prognosis;
                document.getElementById('child-pugh-result').style.display = 'block';
            });
        }

        // --- Signos Vitales ---
        function setupVitalSigns() {
            // Cálculo automático de IMC
            const weightInput = document.getElementById('weight');
            const heightInput = document.getElementById('height');
            const imcOutput = document.getElementById('imc');
            
            function updateIMC() {
                const weight = parseFloat(weightInput.value);
                const height = parseFloat(heightInput.value);
                
                if (weight > 0 && height > 0) {
                    const heightInMeters = height / 100;
                    const imc = weight / (heightInMeters * heightInMeters);
                    imcOutput.value = imc.toFixed(2);
                } else {
                    imcOutput.value = '';
                }
            }
            
            if (weightInput && heightInput && imcOutput) {
                weightInput.addEventListener('input', updateIMC);
                heightInput.addEventListener('input', updateIMC);
            }
            
            // Guardar signos vitales
            document.getElementById('save-vitals')?.addEventListener('click', () => {
                const patientId = document.getElementById('vitals-patient').value;
                if (!patientId) {
                    alert('Por favor, seleccione un paciente.');
                    return;
                }
                
                const patient = simulatedPatients.find(p => p.id === parseInt(patientId));
                const temperature = document.getElementById('temperature').value;
                const pa = document.getElementById('pa').value;
                const fc = document.getElementById('fc').value;
                const fr = document.getElementById('fr').value;
                const spo2 = document.getElementById('spo2').value;
                const weight = document.getElementById('weight').value;
                const height = document.getElementById('height').value;
                const notes = document.getElementById('notes').value;
                
                if (!temperature || !pa || !fc || !fr || !spo2 || !weight || !height) {
                    alert('Por favor, complete todos los campos de signos vitales.');
                    return;
                }
                
                // En una aplicación real, aquí se guardarían los datos
                alert(`Signos vitales guardados para ${patient.nombre}.\n\nTemperatura: ${temperature}°C\nPA: ${pa}\nFC: ${fc} ppm\nFR: ${fr} rpm\nSpO2: ${spo2}%\nPeso: ${weight} kg\nTalla: ${height} cm\nIMC: ${imcOutput.value}`);
                
                // Limpiar formulario
                document.getElementById('temperature').value = '';
                document.getElementById('pa').value = '';
                document.getElementById('fc').value = '';
                document.getElementById('fr').value = '';
                document.getElementById('spo2').value = '';
                document.getElementById('weight').value = '';
                document.getElementById('height').value = '';
                document.getElementById('notes').value = '';
                imcOutput.value = '';
            });
        }

        // --- Recetas ---
        function setupPrescriptions() {
            // Añadir medicamento
            document.getElementById('add-medication')?.addEventListener('click', () => {
                const medicationEntries = document.getElementById('medication-entries');
                const entryCount = medicationEntries.children.length + 1;
                
                const newEntry = document.createElement('div');
                newEntry.className = 'medication-entry';
                newEntry.innerHTML = `
                    <div class="form-row">
                        <div class="form-group flex-grow">
                            <label for="medication-${entryCount}">Medicamento</label>
                            <input type="text" id="medication-${entryCount}" class="medication-name" placeholder="Nombre del medicamento">
                        </div>
                        <div class="form-group">
                            <label for="dose-${entryCount}">Dosis</label>
                            <input type="text" id="dose-${entryCount}" placeholder="10mg">
                        </div>
                        <div class="form-group">
                            <label for="frequency-${entryCount}">Frecuencia</label>
                            <select id="frequency-${entryCount}">
                                <option value="once">1 vez al día</option>
                                <option value="twice">2 veces al día</option>
                                <option value="thrice">3 veces al día</option>
                                <option value="four-times">4 veces al día</option>
                                <option value="as-needed">Según necesidad</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="duration-${entryCount}">Duración</label>
                            <input type="text" id="duration-${entryCount}" placeholder="7 días">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="instructions-${entryCount}">Instrucciones</label>
                        <textarea id="instructions-${entryCount}" rows="2" placeholder="Tomar después de las comidas..."></textarea>
                    </div>
                    <button class="btn btn-secondary remove-medication" data-entry="${entryCount}">
                        <span class="material-symbols-outlined">delete</span> Eliminar
                    </button>
                `;
                
                medicationEntries.appendChild(newEntry);
                
                // Añadir evento para eliminar medicamento
                newEntry.querySelector('.remove-medication').addEventListener('click', function() {
                    medicationEntries.removeChild(newEntry);
                    checkMedicationInteractions();
                });
                
                // Añadir evento para verificar interacciones cuando cambie el nombre del medicamento
                newEntry.querySelector('.medication-name').addEventListener('input', checkMedicationInteractions);
            });
            
            // Verificar interacciones medicamentosas
            function checkMedicationInteractions() {
                const medicationInputs = document.querySelectorAll('.medication-name');
                const medicationNames = Array.from(medicationInputs)
                    .map(input => input.value.trim())
                    .filter(name => name !== '');
                
                const warnings = [];
                
                for (let i = 0; i < medicationNames.length; i++) {
                    const med1 = medicationNames[i];
                    if (medicamentosDB[med1]) {
                        for (let j = i + 1; j < medicationNames.length; j++) {
                            const med2 = medicationNames[j];
                            if (medicamentosDB[med1].interacciones[med2]) {
                                const interaction = medicamentosDB[med1].interacciones[med2];
                                warnings.push({
                                    med1: med1,
                                    med2: med2,
                                    severity: interaction.severidad,
                                    description: interaction.descripcion
                                });
                            }
                            if (medicamentosDB[med2] && medicamentosDB[med2].interacciones[med1]) {
                                const interaction = medicamentosDB[med2].interacciones[med1];
                                warnings.push({
                                    med1: med2,
                                    med2: med1,
                                    severity: interaction.severidad,
                                    description: interaction.descripcion
                                });
                            }
                        }
                    }
                }
                
                const warningDiv = document.getElementById('interactions-warning');
                const warningList = document.getElementById('interactions-list');
                
                if (warnings.length > 0) {
                    let warningText = '';
                    warnings.forEach(warning => {
                        warningText += `<strong>${warning.med1} y ${warning.med2}</strong>: ${warning.description} <span style="color: ${
                            warning.severity === 'fatal' ? 'red' : 
                            warning.severity === 'moderada' ? 'orange' : 'blue'
                        }">(${warning.severity})</span><br>`;
                    });
                    warningList.innerHTML = warningText;
                    warningDiv.style.display = 'block';
                } else {
                    warningDiv.style.display = 'none';
                }
            }
            
            // Verificar interacciones cuando se cambie un nombre de medicamento
            document.addEventListener('input', (e) => {
                if (e.target.classList.contains('medication-name')) {
                    checkMedicationInteractions();
                }
            });
            
            // Emitir receta
            document.getElementById('issue-prescription')?.addEventListener('click', () => {
                const patientId = document.getElementById('recipe-patient').value;
                if (!patientId) {
                    alert('Por favor, seleccione un paciente.');
                    return;
                }
                
                const patient = simulatedPatients.find(p => p.id === parseInt(patientId));
                const medicationCount = document.querySelectorAll('.medication-entry').length;
                
                if (medicationCount === 0) {
                    alert('Por favor, añada al menos un medicamento a la receta.');
                    return;
                }
                
                // Verificar interacciones antes de emitir
                const warningDiv = document.getElementById('interactions-warning');
                if (warningDiv.style.display === 'block') {
                    const confirmIssue = confirm('Hay interacciones medicamentosas detectadas. ¿Desea continuar con la emisión de la receta?');
                    if (!confirmIssue) return;
                }
                
                alert(`Receta emitida para ${patient.nombre} con éxito.\n\nLa receta contiene ${medicationCount} medicamento(s).`);
            });
        }

        // Cargar especialidades en el filtro
        function loadSpecialties() {
            const filterSelect = document.getElementById('specialty-filter');
            if (!filterSelect) return;
            
            const specialties = [...new Set(simulatedPatients.map(p => p.especialidad))];
            specialties.forEach(specialty => {
                const option = document.createElement('option');
                option.value = specialty;
                option.textContent = specialty;
                filterSelect.appendChild(option);
            });
            
            // Filtrado y búsqueda
            const searchInput = document.getElementById('patient-search');
            const specialtyFilter = document.getElementById('specialty-filter');
            
            function applyFilters() {
                const searchTerm = searchInput.value.toLowerCase();
                const selectedSpecialty = specialtyFilter.value.toLowerCase();
                const grid = document.getElementById('patient-grid');
                grid.innerHTML = '';
                
                simulatedPatients
                    .filter(patient => {
                        const matchesSearch = patient.nombre.toLowerCase().includes(searchTerm) ||
                                              patient.diagnosticoPrincipal.toLowerCase().includes(searchTerm);
                        const matchesSpecialty = selectedSpecialty === '' || patient.especialidad.toLowerCase() === selectedSpecialty;
                        return matchesSearch && matchesSpecialty;
                    })
                    .forEach(patient => {
                        const card = document.createElement('div');
                        card.className = 'patient-card';
                        card.innerHTML = `
                            <h3>${patient.nombre}</h3>
                            <p><strong>Edad:</strong> ${patient.edad}</p>
                            <p><strong>Diagnóstico Principal:</strong> ${patient.diagnosticoPrincipal}</p>
                            <p><strong>Especialidad:</strong> ${patient.especialidad}</p>
                            <button class="btn btn-secondary btn-view-history" data-patient-id="${patient.id}">
                                <span class="material-symbols-outlined">history</span> Ver Historia Completa
                            </button>
                        `;
                        grid.appendChild(card);
                    });
                
                // Re-agregar listeners a los nuevos botones
                document.querySelectorAll('.btn-view-history').forEach(button => {
                    button.addEventListener('click', handleViewHistory);
                });
            }
            
            searchInput?.addEventListener('input', applyFilters);
            specialtyFilter?.addEventListener('change', applyFilters);
        }

        // --- Gráficos (Chart.js) ---
        // Cargar Chart.js desde CDN
        const chartScript = document.createElement('script');
        chartScript.src = 'https://cdn.jsdelivr.net/npm/chart.js';
        chartScript.onload = () => {
            console.log('Chart.js cargado.');
            // Datos simulados para el gráfico
            const chartData = {
                labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
                datasets: [{
                    label: 'Presión Arterial (Sistólica)',
                    data: [130, 128, 125, 122, 120, 118],
                    borderColor: '#1a73e8',
                    fill: false,
                    tension: 0.1
                }, {
                    label: 'Presión Arterial (Diastólica)',
                    data: [85, 84, 82, 80, 79, 78],
                    borderColor: '#34a853',
                    fill: false,
                    tension: 0.1
                }]
            };
            const ctx = document.getElementById('vitalSignsChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: chartData,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Evolución de Signos Vitales'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    }
                }
            });
        };
        document.head.appendChild(chartScript);
    </script>
</body>
</html>
```
