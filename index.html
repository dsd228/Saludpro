
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Enfermería DAVID · Final Full — procedimientos, PAE, combinador fármacos, enfermedades, RCP, PWA.">
    <title>Enfermería DAVID · Final Full</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg: linear-gradient(180deg, #e0f7fa, #b2ebf2);
            --glass: rgba(255, 255, 255, 0.85);
            --glass-2: rgba(255, 255, 255, 0.2);
            --accent: #26a69a;
            --accent-2: #4db6ac;
            --primary-blue: #1a73e8;
            --primary-blue-darker: #0d47a1;
            --primary-blue-lighter: #e8f0fe;
            --success-green: #34a853;
            --warning-yellow: #f9ab00;
            --alert-red: #ea4335;
            --accent-teal: #00897b;
            --accent-purple: #7b1fa2;
            --background-light: #f8f9fa;
            --text-dark: #2c4a52;
            --text-light: #ffffff;
            --muted: #546e7a;
            --danger: #e57373;
            --card-radius: 16px;
            --shadow: 0 10px 30px rgba(38, 166, 154, 0.15);
            --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.15);
            --tap: 48px;
            --font: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, Arial;
            --maxwidth: 1200px;
            --border: #b2ebf2;
            --border-light: #e0e0e0;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        :root[data-theme="dark"] {
            --bg: linear-gradient(180deg, #0a232f, #08313a);
            --glass: rgba(16, 52, 64, 0.85);
            --glass-2: rgba(255, 255, 255, 0.08);
            --accent: #4db6ac;
            --accent-2: #26a69a;
            --text-dark: #e0f7fa;
            --text-light: #ffffff;
            --muted: #8caab5;
            --border: #006064;
            --border-light: #1e3a4a;
            --background-light: #0a232f;
            --primary-blue-lighter: #0a1f2c;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            transition: var(--transition);
        }
        
        html, body {
            height: 100%;
            margin: 0;
            font-family: var(--font);
            background: var(--bg);
            -webkit-font-smoothing: antialiased;
            display: flex;
            justify-content: center;
            padding: 12px;
            color: var(--text-dark);
        }
        
        .app {
            width: 100%;
            max-width: var(--maxwidth);
            height: calc(100vh - 24px);
            display: flex;
            flex-direction: column;
            background: var(--glass);
            backdrop-filter: blur(12px);
            border-radius: var(--card-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            position: relative;
        }
        
        header {
            padding: 16px 24px;
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        header h1 {
            font-size: 1.6rem;
            font-weight: 600;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .brand-icon {
            font-size: 1.8rem;
            color: var(--accent);
        }
        
        .controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .theme-toggle {
            background: none;
            border: none;
            font-size: 1.4rem;
            cursor: pointer;
            color: var(--accent);
            padding: 8px;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .theme-toggle:hover {
            background: var(--glass-2);
            transform: rotate(30deg);
        }
        
        .container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .sidebar {
            width: 300px;
            background: var(--glass);
            border-right: 1px solid var(--border);
            padding: 16px;
            overflow-y: auto;
            transition: var(--transition);
        }
        
        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 0;
            margin-bottom: 16px;
            border-bottom: 1px solid var(--border-light);
        }
        
        .sidebar-header h3 {
            font-size: 1.1rem;
            color: var(--accent);
            font-weight: 600;
        }
        
        .cat-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        .cat-btn {
            padding: 14px 18px;
            border: none;
            border-radius: 12px;
            background: var(--glass-2);
            color: var(--text-dark);
            font-weight: 500;
            cursor: pointer;
            text-align: left;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .cat-btn:hover {
            background: var(--accent-2);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(38, 166, 154, 0.2);
        }
        
        .cat-btn.active {
            background: var(--accent);
            color: white;
            box-shadow: 0 6px 16px rgba(38, 166, 154, 0.2);
        }
        
        .cat-btn i {
            font-size: 1.4rem;
            width: 24px;
            text-align: center;
        }
        
        .cat-btn[data-cat="higiene"] i { color: #4CAF50; }
        .cat-btn[data-cat="curaciones"] i { color: #2196F3; }
        .cat-btn[data-cat="farmaco"] i { color: #9C27B0; }
        .cat-btn[data-cat="emergencias"] i { color: #F44336; }
        .cat-btn[data-cat="movilizacion"] i { color: #FF9800; }
        .cat-btn[data-cat="nutricion"] i { color: #8D6E63; }
        .cat-btn[data-cat="infeccion"] i { color: #795548; }
        .cat-btn[data-cat="medicamentos"] i { color: #009688; }
        .cat-btn[data-cat="enfermedades"] i { color: #607D8B; }
        .cat-btn[data-cat="pae"] i { color: #3F51B5; }
        .cat-btn[data-cat="rcp"] i { color: #E91E63; }
        .cat-btn[data-cat="calculadoras"] i { color: #FF5722; }
        .cat-btn[data-cat="recursos"] i { color: #00BCD4; }
        .cat-btn[data-cat="pacientes"] i { color: #673AB7; }
        
        .small {
            font-size: 0.85rem;
            color: var(--muted);
            margin-top: 8px;
            line-height: 1.4;
        }
        
        main {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            background: var(--background-light);
        }
        
        .search-container {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            position: sticky;
            top: 80px;
            background: var(--background-light);
            padding: 8px 0;
            z-index: 50;
        }
        
        .input {
            flex: 1;
            padding: 14px 18px;
            border: 1px solid var(--border-light);
            border-radius: 12px;
            font-family: var(--font);
            font-size: 1rem;
            background: white;
            color: var(--text-dark);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(38, 166, 154, 0.2);
        }
        
        .btn {
            padding: 14px 18px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn.primary {
            background: var(--accent);
            color: white;
        }
        
        .btn.primary:hover {
            background: var(--accent-2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(38, 166, 154, 0.3);
        }
        
        .btn.secondary {
            background: var(--primary-blue);
            color: white;
        }
        
        .btn.secondary:hover {
            background: var(--primary-blue-darker);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);
        }
        
        .btn.ghost {
            background: transparent;
            color: var(--accent);
            border: 1px solid var(--accent);
        }
        
        .btn.ghost:hover {
            background: var(--glass-2);
            transform: translateY(-2px);
        }
        
        .btn.small {
            padding: 8px 12px;
            font-size: 0.9rem;
        }
        
        .content-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .category-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            transition: var(--transition);
        }
        
        .category-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }
        
        .category-card h2 {
            color: var(--accent);
            margin-bottom: 16px;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .category-card h2 i {
            font-size: 1.5rem;
        }
        
        .category-card h3 {
            color: var(--accent-2);
            margin: 16px 0 10px 0;
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .category-card h4 {
            color: var(--primary-blue);
            margin: 10px 0 6px 0;
            font-size: 1.1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .procedure {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px dashed var(--border-light);
            transition: var(--transition);
        }
        
        .procedure:hover {
            border-bottom-color: var(--accent-2);
        }
        
        .procedure:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .procedure h3 {
            color: var(--accent-2);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .procedure h3 i {
            font-size: 1.2rem;
            color: var(--accent);
        }
        
        .procedure p {
            margin: 5px 0;
            color: var(--text-dark);
            line-height: 1.5;
        }
        
        .procedure .summary {
            font-style: italic;
            color: var(--muted);
            margin-bottom: 10px;
            padding: 12px;
            background: var(--primary-blue-lighter);
            border-radius: 8px;
            border-left: 4px solid var(--primary-blue);
        }
        
        .materials, .steps, .notes {
            margin: 10px 0;
        }
        
        .materials ul, .steps ol {
            margin: 8px 0;
            padding-left: 24px;
        }
        
        .materials li, .steps li {
            margin: 5px 0;
            display: flex;
            align-items: flex-start;
            gap: 8px;
        }
        
        .materials li::before, .steps li::before {
            content: "•";
            color: var(--accent);
            font-weight: bold;
            margin-top: 6px;
        }
        
        .steps li::before {
            content: counter(step);
            counter-increment: step;
            background: var(--accent);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            margin-top: 4px;
        }
        
        .notes {
            background: var(--primary-blue-lighter);
            padding: 14px 18px;
            border-radius: 10px;
            border-left: 4px solid var(--primary-blue);
            margin: 12px 0;
            font-size: 0.95rem;
        }
        
        .notes i {
            color: var(--primary-blue);
            margin-right: 8px;
        }
        
        .disease-panel {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            margin-top: 20px;
            transition: var(--transition);
        }
        
        .disease-panel h2 {
            color: var(--accent);
            margin-bottom: 16px;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .disease-panel h2 i {
            font-size: 1.5rem;
        }
        
        .disease-item {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px dashed var(--border-light);
            transition: var(--transition);
        }
        
        .disease-item:hover {
            border-bottom-color: var(--accent-2);
        }
        
        .disease-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .disease-item strong {
            color: var(--accent-2);
            font-size: 1.1rem;
        }
        
        .disease-item .small {
            font-size: 0.95rem;
            color: var(--muted);
            margin-top: 6px;
            line-height: 1.5;
        }
        
        .med-combo {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            margin-top: 20px;
            transition: var(--transition);
        }
        
        .med-combo h2 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .med-combo h2 i {
            font-size: 1.5rem;
        }
        
        .form-row {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        
        .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .form-group label i {
            color: var(--accent);
            font-size: 1.1rem;
        }
        
        select.form-control, input.form-control {
            width: 100%;
            padding: 14px 18px;
            border: 1px solid var(--border-light);
            border-radius: 12px;
            font-family: var(--font);
            font-size: 1rem;
            background: white;
            color: var(--text-dark);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        select.form-control:focus, input.form-control:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(38, 166, 154, 0.2);
        }
        
        .interactions-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            animation: fadeIn 0.3s ease;
        }
        
        .interactions-warning.danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .interactions-warning.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .interactions-warning i {
            font-size: 1.5rem;
            margin-top: 2px;
        }
        
        .interactions-warning.danger i {
            color: #c82333;
        }
        
        .interactions-warning.success i {
            color: #218838;
        }
        
        .interactions-list {
            margin: 8px 0 0 40px;
            flex: 1;
        }
        
        .interactions-list li {
            margin: 6px 0;
            padding: 4px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .interactions-list li:last-child {
            border-bottom: none;
        }
        
        .pae-form {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            margin-top: 20px;
            transition: var(--transition);
        }
        
        .pae-form h2 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .pae-form h2 i {
            font-size: 1.5rem;
        }
        
        .rcp-guide {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            margin-top: 20px;
            transition: var(--transition);
        }
        
        .rcp-guide h2 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rcp-guide h2 i {
            font-size: 1.5rem;
        }
        
        .rcp-step {
            margin-bottom: 20px;
            padding-left: 32px;
            position: relative;
            transition: var(--transition);
        }
        
        .rcp-step:hover {
            background: var(--primary-blue-lighter);
            border-radius: 8px;
            padding: 12px 16px 12px 48px;
        }
        
        .rcp-step::before {
            content: attr(data-step);
            position: absolute;
            left: 0;
            top: 0;
            width: 28px;
            height: 28px;
            background: var(--accent);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: bold;
            z-index: 1;
        }
        
        .score-result {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            margin-top: 20px;
            text-align: center;
            transition: var(--transition);
        }
        
        .score-result h3 {
            color: var(--accent);
            margin-bottom: 16px;
            font-size: 1.3rem;
        }
        
        .score-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--accent);
            margin: 16px 0;
            text-shadow: 0 2px 4px rgba(38, 166, 154, 0.2);
        }
        
        .score-category {
            font-size: 1.3rem;
            font-weight: 500;
            color: var(--accent-2);
        }
        
        .tab-container {
            margin-top: 20px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-light);
            margin-bottom: 20px;
            border-radius: 12px 12px 0 0;
            overflow: hidden;
        }
        
        .tab {
            padding: 14px 20px;
            cursor: pointer;
            font-weight: 500;
            color: var(--muted);
            border-bottom: 3px solid transparent;
            transition: var(--transition);
            background: var(--glass-2);
        }
        
        .tab:first-child {
            border-radius: 12px 0 0 0;
        }
        
        .tab:last-child {
            border-radius: 0 12px 0 0;
        }
        
        .tab:hover {
            background: var(--accent-2);
            color: white;
        }
        
        .tab.active {
            color: var(--accent);
            border-bottom: 3px solid var(--accent);
            background: rgba(38, 166, 154, 0.1);
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .calculator-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .calculator-form {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            transition: var(--transition);
        }
        
        .calculator-form:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }
        
        .calculator-form h3 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .calculator-form h3 i {
            font-size: 1.4rem;
        }
        
        .patient-list {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            margin-top: 20px;
            transition: var(--transition);
        }
        
        .patient-list h2 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .patient-list h2 i {
            font-size: 1.5rem;
        }
        
        .patient-card {
            background: var(--primary-blue-lighter);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 5px solid var(--primary-blue);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .patient-card:hover {
            transform: translateX(6px);
            background: rgba(26, 115, 232, 0.15);
        }
        
        .patient-card::after {
            content: "→";
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            transition: var(--transition);
        }
        
        .patient-card:hover::after {
            opacity: 1;
        }
        
        .patient-card:last-child {
            margin-bottom: 0;
        }
        
        .patient-card h3 {
            color: var(--primary-blue-darker);
            margin-bottom: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .patient-card h3 i {
            color: var(--primary-blue);
            font-size: 1.2rem;
        }
        
        .patient-card p {
            margin: 3px 0;
            font-size: 0.95rem;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .patient-card p i {
            color: var(--muted);
            font-size: 1rem;
            width: 20px;
            text-align: center;
        }
        
        .resource-panel {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            margin-top: 20px;
            transition: var(--transition);
        }
        
        .resource-panel h2 {
            color: var(--accent);
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .resource-panel h2 i {
            font-size: 1.5rem;
        }
        
        .resource-card {
            background: var(--primary-blue-lighter);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 5px solid var(--primary-blue);
            transition: var(--transition);
        }
        
        .resource-card:hover {
            transform: translateX(6px);
            background: rgba(26, 115, 232, 0.15);
        }
        
        .resource-card:last-child {
            margin-bottom: 0;
        }
        
        .resource-card h3 {
            color: var(--primary-blue-darker);
            margin-bottom: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .resource-card h3 i {
            color: var(--primary-blue);
            font-size: 1.2rem;
        }
        
        .resource-card p {
            margin: 3px 0;
            font-size: 0.95rem;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .resource-card p i {
            color: var(--muted);
            font-size: 1rem;
            width: 20px;
            text-align: center;
        }
        
        .welcome-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }
        
        .welcome-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }
        
        .welcome-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-md);
        }
        
        .welcome-card i {
            font-size: 2.5rem;
            color: var(--accent);
            margin-bottom: 12px;
        }
        
        .welcome-card h3 {
            color: var(--accent);
            margin-bottom: 8px;
            font-size: 1.2rem;
        }
        
        .welcome-card p {
            color: var(--muted);
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .rcp-controls {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .rcp-timer {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--accent);
            margin: 16px 0;
            text-align: center;
            font-family: 'Courier New', monospace;
            background: rgba(38, 166, 154, 0.1);
            padding: 12px;
            border-radius: 12px;
            border: 2px solid var(--accent);
        }
        
        .rcp-state {
            font-size: 0.95rem;
            color: var(--muted);
            margin-bottom: 12px;
            text-align: center;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                max-height: 240px;
                border-right: none;
                border-bottom: 1px solid var(--border);
                position: relative;
                z-index: 60;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .form-group {
                min-width: 100%;
            }
            
            .calculator-container {
                grid-template-columns: 1fr;
            }
            
            .welcome-actions {
                grid-template-columns: 1fr;
            }
            
            .rcp-controls {
                flex-direction: column;
            }
            
            header {
                padding: 16px;
            }
            
            .search-container {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .app {
                border-radius: 12px;
            }
            
            .category-card, .disease-panel, .med-combo, .pae-form, .rcp-guide, .patient-list, .resource-panel {
                border-radius: 12px;
                padding: 16px;
            }
            
            .cat-btn {
                padding: 12px 16px;
                font-size: 0.95rem;
            }
            
            .input, .btn {
                font-size: 0.95rem;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <header>
            <h1><i class="fas fa-hospital-alt brand-icon"></i> Enfermería DAVID · Final Full</h1>
            <div class="controls">
                <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </header>
        
        <div class="container">
            <nav class="sidebar" id="sidebar" aria-label="Categorías">
                <div class="sidebar-header">
                    <i class="fas fa-list"></i>
                    <h3>Categorías</h3>
                </div>
                <div class="cat-grid" role="navigation">
                    <button class="cat-btn" data-cat="higiene">
                        <i class="fas fa-soap"></i>
                        Higiene
                    </button>
                    <button class="cat-btn" data-cat="curaciones">
                        <i class="fas fa-band-aid"></i>
                        Curaciones
                    </button>
                    <button class="cat-btn" data-cat="farmaco">
                        <i class="fas fa-pills"></i>
                        Farmacología
                    </button>
                    <button class="cat-btn" data-cat="emergencias">
                        <i class="fas fa-ambulance"></i>
                        Emergencias
                    </button>
                    <button class="cat-btn" data-cat="movilizacion">
                        <i class="fas fa-wheelchair"></i>
                        Movilización
                    </button>
                    <button class="cat-btn" data-cat="nutricion">
                        <i class="fas fa-utensils"></i>
                        Nutrición
                    </button>
                    <button class="cat-btn" data-cat="infeccion">
                        <i class="fas fa-virus"></i>
                        Control infección
                    </button>
                    <button class="cat-btn" data-cat="medicamentos">
                        <i class="fas fa-prescription-bottle-alt"></i>
                        Medicamentos
                    </button>
                    <button class="cat-btn" data-cat="enfermedades">
                        <i class="fas fa-notes-medical"></i>
                        Enfermedades
                    </button>
                    <button class="cat-btn" data-cat="pae">
                        <i class="fas fa-clipboard-list"></i>
                        PAE
                    </button>
                    <button class="cat-btn" data-cat="rcp">
                        <i class="fas fa-heartbeat"></i>
                        RCP
                    </button>
                    <button class="cat-btn" data-cat="calculadoras">
                        <i class="fas fa-calculator"></i>
                        Calculadoras
                    </button>
                    <button class="cat-btn" data-cat="recursos">
                        <i class="fas fa-book"></i>
                        Recursos
                    </button>
                    <button class="cat-btn" data-cat="pacientes">
                        <i class="fas fa-users"></i>
                        Pacientes
                    </button>
                </div>
                <div class="small">
                    Toque una categoría. Cada botón abre sub-funciones y procedimientos.
                </div>
            </nav>
            
            <main class="panel" id="mainPanel" aria-live="polite">
                <div class="search-container">
                    <input id="globalSearch" class="input" placeholder="Buscar procedimiento/enfermedad/medicamento..." aria-label="Buscar">
                    <button id="searchBtn" class="btn primary">
                        <i class="fas fa-search"></i> Buscar
                    </button>
                    <button id="openAllBtn" class="btn secondary">
                        <i class="fas fa-expand"></i> Abrir Todo
                    </button>
                </div>
                
                <div class="content-area" id="contentArea">
                    <div class="category-card">
                        <h2><i class="fas fa-home"></i> Bienvenido a Enfermería DAVID</h2>
                        <p>Seleccione una categoría del menú lateral para acceder a procedimientos, guías clínicas, combinador de fármacos, enfermedades y más.</p>
                        <p>Esta aplicación proporciona acceso rápido a información esencial para profesionales de enfermería y salud.</p>
                        
                        <div class="welcome-actions">
                            <div class="welcome-card" id="quickRcpCard">
                                <i class="fas fa-heartbeat"></i>
                                <h3>Guía Rápida de RCP</h3>
                                <p>Acceda rápidamente a los pasos esenciales de la reanimación cardiopulmonar</p>
                            </div>
                            <div class="welcome-card" id="quickMedCard">
                                <i class="fas fa-prescription-bottle-alt"></i>
                                <h3>Combinador de Fármacos</h3>
                                <p>Verifique interacciones medicamentosas peligrosas en segundos</p>
                            </div>
                            <div class="welcome-card" id="quickPaeCard">
                                <i class="fas fa-clipboard-list"></i>
                                <h3>Crear PAE</h3>
                                <p>Genere planes de atención de enfermería personalizados</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Panel de enfermedades -->
                <div class="disease-panel" id="diseasePanel" style="display:none;">
                    <h2><i class="fas fa-notes-medical"></i> Enfermedades</h2>
                    <div id="diseaseResults"></div>
                    <div style="margin-top:12px">
                        <button id="wikiFetchBtn" class="btn primary">
                            <i class="fas fa-wikipedia-w"></i> Buscar en Wikipedia
                        </button>
                        <div id="wikiOutput" class="small" style="margin-top:10px"></div>
                    </div>
                </div>
                
                <!-- Combinador de fármacos -->
                <div class="med-combo" id="medCombo" style="display:none;">
                    <h2><i class="fas fa-prescription-bottle-alt"></i> Combinador de Fármacos</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="medSearchBox"><i class="fas fa-search"></i> Buscar fármaco</label>
                            <input type="text" id="medSearchBox" class="form-control" placeholder="Buscar fármaco...">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="medSelectA"><i class="fas fa-capsules"></i> Medicamento A</label>
                            <select id="medSelectA" class="form-control">
                                <option value="">Seleccionar...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="medSelectB"><i class="fas fa-capsules"></i> Medicamento B</label>
                            <select id="medSelectB" class="form-control">
                                <option value="">Seleccionar...</option>
                            </select>
                        </div>
                    </div>
                    <button id="checkInteractionsBtn" class="btn primary">
                        <i class="fas fa-exchange-alt"></i> Verificar Interacciones
                    </button>
                    <div id="medAlert" style="margin-top:20px;"></div>
                    <details style="margin-top:10px">
                        <summary class="small">
                            <i class="fas fa-exclamation-triangle"></i> Lista 'Nunca combinar' (críticas)
                        </summary>
                        <div id="neverList" style="margin-top:10px;max-height:280px;overflow:auto"></div>
                    </details>
                </div>
                
                <!-- Formulario PAE -->
                <div class="pae-form" id="paeForm" style="display:none;">
                    <h2><i class="fas fa-clipboard-list"></i> Plan de Atención de Enfermería (PAE)</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="patientName"><i class="fas fa-user"></i> Nombre del Paciente</label>
                            <input type="text" id="patientName" class="form-control" placeholder="Nombre completo">
                        </div>
                        <div class="form-group">
                            <label for="patientAge"><i class="fas fa-birthday-cake"></i> Edad</label>
                            <input type="number" id="patientAge" class="form-control" placeholder="Años">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="diagnosis"><i class="fas fa-diagnoses"></i> Diagnóstico Médico</label>
                        <input type="text" id="diagnosis" class="form-control" placeholder="Diagnóstico principal">
                    </div>
                    <div class="form-group">
                        <label for="nursingDiagnosis"><i class="fas fa-stethoscope"></i> Diagnóstico de Enfermería</label>
                        <select id="nursingDiagnosis" class="form-control">
                            <option value="">Seleccionar diagnóstico...</option>
                            <option value="dolor">Dolor agudo</option>
                            <option value="riesgo-caidas">Riesgo de caídas</option>
                            <option value="alteracion-ventilacion">Alteración de la ventilación espontánea</option>
                            <option value="integridad-cutanea">Riesgo de deterioro de la integridad cutánea</option>
                            <option value="nutricion">Desequilibrio de la nutrición</option>
                            <option value="ansiedad">Ansiedad</option>
                            <option value="movilidad">Alteración de la movilidad física</option>
                            <option value="perfusión">Riesgo de perfusión tisular ineficaz</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="goals"><i class="fas fa-bullseye"></i> Objetivos</label>
                            <textarea id="goals" class="form-control" rows="3" placeholder="Objetivos a alcanzar..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="interventions"><i class="fas fa-hand-holding-medical"></i> Intervenciones</label>
                            <textarea id="interventions" class="form-control" rows="3" placeholder="Intervenciones de enfermería..."></textarea>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="pae_name"><i class="fas fa-file-signature"></i> Nombre del PAE</label>
                            <input type="text" id="pae_name" class="form-control" placeholder="Nombre del plan">
                        </div>
                        <div class="form-group">
                            <label for="pae_diag"><i class="fas fa-diagnoses"></i> Diagnóstico</label>
                            <input type="text" id="pae_diag" class="form-control" placeholder="Diagnóstico principal">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="pae_plan"><i class="fas fa-clipboard"></i> Plan de Cuidados</label>
                        <textarea id="pae_plan" class="form-control" rows="4" placeholder="Describa el plan de cuidados..."></textarea>
                    </div>
                    <div style="margin-top:20px;display:flex;gap:10px;flex-wrap:wrap">
                        <button id="generatePaeBtn" class="btn primary">
                            <i class="fas fa-magic"></i> Generar PAE
                        </button>
                        <button id="savePaeBtn" class="btn secondary">
                            <i class="fas fa-save"></i> Guardar PAE
                        </button>
                        <button id="exportPaeBtn" class="btn ghost">
                            <i class="fas fa-file-export"></i> Exportar
                        </button>
                    </div>
                    <div id="paeMsg" class="small" style="margin-top:10px"></div>
                </div>
                
                <!-- Guía de RCP -->
                <div class="rcp-guide" id="rcpGuide" style="display:none;">
                    <h2><i class="fas fa-heartbeat"></i> RCP Básica (Adulto)</h2>
                    <div class="rcp-step" data-step="1">
                        <strong>Verificar seguridad del entorno</strong>
                        <p>Asegúrese de que el área es segura para usted y el paciente antes de intervenir.</p>
                    </div>
                    <div class="rcp-step" data-step="2">
                        <strong>Comprobar respuesta del paciente</strong>
                        <p>Agite suavemente los hombros y pregunte "¿Está bien?". Si no hay respuesta, proceda.</p>
                    </div>
                    <div class="rcp-step" data-step="3">
                        <strong>Llamar a emergencias</strong>
                        <p>Si está solo, grite pidiendo ayuda. Si hay alguien más, pídale que llame al 112 y traiga un DEA.</p>
                    </div>
                    <div class="rcp-step" data-step="4">
                        <strong>Iniciar compresiones torácicas</strong>
                        <p>Coloque las manos en el centro del pecho. Comprima a una profundidad de 5-6 cm a una velocidad de 100-120 por minuto.</p>
                    </div>
                    <div class="rcp-step" data-step="5">
                        <strong>Apertura de vía aérea y ventilaciones</strong>
                        <p>Después de 30 compresiones, abra la vía aérea con la maniobra frente-mentón. Dé 2 ventilaciones de 1 segundo cada una.</p>
                    </div>
                    <div class="rcp-step" data-step="6">
                        <strong>Usar DEA si disponible</strong>
                        <p>Siga las instrucciones del DEA. No toque al paciente durante la descarga.</p>
                    </div>
                    <div class="rcp-step" data-step="7">
                        <strong>Continuar RCP</strong>
                        <p>Continúe con ciclos de 30:2 (30 compresiones, 2 ventilaciones) hasta que llegue ayuda o el paciente reaccione.</p>
                    </div>
                    <div class="rcp-controls">
                        <div class="rcp-state" id="rcpState">Estado: detenido</div>
                        <div class="rcp-timer" id="rcpTimer">00:00</div>
                        <button id="rcpStart" class="btn primary">
                            <i class="fas fa-play"></i> Iniciar RCP
                        </button>
                        <button id="rcpStop" class="btn ghost">
                            <i class="fas fa-stop"></i> Detener
                        </button>
                    </div>
                </div>
                
                <!-- Calculadoras -->
                <div class="calculator-container" id="calculadoras" style="display:none;">
                    <div class="calculator-form">
                        <h3><i class="fas fa-weight"></i> IMC (Índice de Masa Corporal)</h3>
                        <div class="form-group">
                            <label for="imc_weight"><i class="fas fa-weight-hanging"></i> Peso (kg)</label>
                            <input type="number" id="imc_weight" class="form-control" placeholder="Ej: 70">
                        </div>
                        <div class="form-group">
                            <label for="imc_height"><i class="fas fa-ruler-vertical"></i> Altura (cm)</label>
                            <input type="number" id="imc_height" class="form-control" placeholder="Ej: 170">
                        </div>
                        <button id="calculateImc" class="btn primary" style="margin-top:20px;">
                            <i class="fas fa-calculator"></i> Calcular IMC
                        </button>
                        <div id="imc-result" style="margin-top:20px;display:none;">
                            <div class="score-value" id="imc-value"></div>
                            <div class="score-category" id="imc-category"></div>
                        </div>
                    </div>
                    
                    <div class="calculator-form">
                        <h3><i class="fas fa-filter"></i> Filtración Glomerular (CKD-EPI)</h3>
                        <div class="form-group">
                            <label for="creatinine"><i class="fas fa-vial"></i> Creatinina (mg/dL)</label>
                            <input type="number" id="creatinine" class="form-control" placeholder="Ej: 1.0">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-venus-mars"></i> Sexo</label>
                            <div style="display:flex;gap:16px;margin-top:8px;">
                                <label style="display:flex;align-items:center;gap:6px;">
                                    <input type="radio" name="sex" value="male" checked> 
                                    <i class="fas fa-male"></i> Hombre
                                </label>
                                <label style="display:flex;align-items:center;gap:6px;">
                                    <input type="radio" name="sex" value="female"> 
                                    <i class="fas fa-female"></i> Mujer
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="age"><i class="fas fa-birthday-cake"></i> Edad</label>
                            <input type="number" id="age" class="form-control" placeholder="Ej: 45">
                        </div>
                        <button id="calculateFiltration" class="btn primary" style="margin-top:20px;">
                            <i class="fas fa-calculator"></i> Calcular Filtración
                        </button>
                        <div id="filtration-result" style="margin-top:20px;display:none;">
                            <div class="score-value" id="filtration-value"></div>
                            <div class="score-category" id="filtration-category"></div>
                        </div>
                    </div>
                    
                    <div class="calculator-form">
                        <h3><i class="fas fa-heart"></i> SCORE (Riesgo Cardiovascular)</h3>
                        <div class="form-group">
                            <label for="score_age"><i class="fas fa-birthday-cake"></i> Edad</label>
                            <input type="number" id="score_age" class="form-control" placeholder="Ej: 55">
                        </div>
                        <div class="form-group">
                            <label for="total-cholesterol"><i class="fas fa-vial"></i> Colesterol total (mg/dL)</label>
                            <input type="number" id="total-cholesterol" class="form-control" placeholder="Ej: 220">
                        </div>
                        <div class="form-group">
                            <label for="hdl-cholesterol"><i class="fas fa-vial"></i> HDL Colesterol (mg/dL)</label>
                            <input type="number" id="hdl-cholesterol" class="form-control" placeholder="Ej: 50">
                        </div>
                        <div class="form-group">
                            <label for="systolic-pressure"><i class="fas fa-heartbeat"></i> Presión sistólica (mmHg)</label>
                            <input type="number" id="systolic-pressure" class="form-control" placeholder="Ej: 140">
                        </div>
                        <div class="form-group">
                            <label style="display:flex;align-items:center;gap:10px;">
                                <input type="checkbox" id="smoker"> 
                                <i class="fas fa-smoking"></i> Fumador
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display:flex;align-items:center;gap:10px;">
                                <input type="checkbox" id="diabetes"> 
                                <i class="fas fa-diabetes"></i> Diabetes
                            </label>
                        </div>
                        <button id="calculateScore" class="btn primary" style="margin-top:20px;">
                            <i class="fas fa-calculator"></i> Calcular SCORE
                        </button>
                        <div id="score-result" style="margin-top:20px;display:none;">
                            <div class="score-value" id="score-value"></div>
                            <div class="score-category" id="score-category"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Lista de pacientes -->
                <div class="patient-list" id="pacientes" style="display:none;">
                    <h2><i class="fas fa-users"></i> Gestión de Pacientes</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="patient-search"><i class="fas fa-search"></i> Buscar paciente</label>
                            <input type="text" id="patient-search" class="form-control" placeholder="Nombre del paciente...">
                        </div>
                        <div class="form-group">
                            <label for="patient-specialty"><i class="fas fa-stethoscope"></i> Especialidad</label>
                            <select id="patient-specialty" class="form-control">
                                <option value="">Todas</option>
                                <option value="Cardiología">Cardiología</option>
                                <option value="Neumología">Neumología</option>
                                <option value="Endocrinología">Endocrinología</option>
                                <option value="Neurología">Neurología</option>
                                <option value="Oncología">Oncología</option>
                                <option value="Nefrología">Nefrología</option>
                            </select>
                        </div>
                    </div>
                    <button id="addPatientBtn" class="btn primary" style="margin-top:10px;">
                        <i class="fas fa-plus"></i> Agregar Paciente
                    </button>
                    <div id="patients-container"></div>
                </div>
                
                <!-- Recursos educativos -->
                <div class="resource-panel" id="recursos" style="display:none;">
                    <h2><i class="fas fa-book"></i> Recursos Educativos</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="resource-search"><i class="fas fa-search"></i> Buscar recurso</label>
                            <input type="text" id="resource-search" class="form-control" placeholder="Título o etiqueta...">
                        </div>
                        <div class="form-group">
                            <label for="resource-category"><i class="fas fa-tags"></i> Categoría</label>
                            <select id="resource-category" class="form-control">
                                <option value="">Todas</option>
                                <option value="Protocolos">Protocolos</option>
                                <option value="Guías">Guías</option>
                                <option value="Videos">Videos</option>
                                <option value="Imágenes">Imágenes</option>
                                <option value="Artículos">Artículos</option>
                            </select>
                        </div>
                    </div>
                    <button id="addResourceBtn" class="btn primary" style="margin-top:10px;">
                        <i class="fas fa-plus"></i> Agregar Recurso
                    </button>
                    <div id="resources-container"></div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Helper function to get element by ID
        function $(id) {
            return document.getElementById(id);
        }
        
        // Theme toggle functionality
        const themeToggle = $('themeToggle');
        const html = document.documentElement;
        const themeIcon = themeToggle.querySelector('i');
        
        // Check for saved theme preference or use preferred color scheme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            html.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            html.setAttribute('data-theme', 'dark');
            updateThemeIcon('dark');
        } else {
            updateThemeIcon('light');
        }
        
        function updateThemeIcon(theme) {
            if (theme === 'dark') {
                themeIcon.className = 'fas fa-sun';
            } else {
                themeIcon.className = 'fas fa-moon';
            }
        }
        
        themeToggle.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        });
        
        // Procedimientos de enfermería
        const PROCEDURES = {
            higiene: [
                {
                    id: 'lavado_mano',
                    title: 'Lavado de manos',
                    summary: 'Técnica esencial para prevenir infecciones.',
                    materials: ['Jabón', 'Agua', 'Toalla'],
                    steps: [
                        'Retirar joyas',
                        'Mojar y aplicar jabón/gel',
                        'Frotar palmas/dorsos/entre dedos ≥20s',
                        'Enjuagar y secar'
                    ],
                    notes: 'Crucial antes y después del contacto con paciente.'
                },
                {
                    id: 'baño_cama',
                    title: 'Baño en cama',
                    summary: 'Higiene integral del paciente encamado.',
                    materials: ['Toallas', 'Agua tibia', 'Jabón', 'Guantes'],
                    steps: [
                        'Preparar equipo',
                        'Proteger intimidad',
                        'Limpiar de proximal a distal',
                        'Secar y vestir'
                    ],
                    notes: ''
                },
                {
                    id: 'higiene_oral',
                    title: 'Higiene oral',
                    summary: 'Prevención de infecciones orales y cuidado de mucosas.',
                    materials: ['Cepillo suave', 'Pasta oral sin flúor si indicado', 'Colutorio'],
                    steps: [
                        'Explicar',
                        'Posicionar',
                        'Limpiar suavemente',
                        'Enjuagar y documentar'
                    ],
                    notes: ''
                },
                {
                    id: 'cuidado_ongles',
                    title: 'Cuidado de uñas',
                    summary: 'Prevención de colonización bacteriana en uñas largas.',
                    materials: ['Tijeras o cortaúñas', 'Lima'],
                    steps: [
                        'Cortar con técnica',
                        'No cortar cutícula si no indicado'
                    ],
                    notes: 'Evitar instrumentos compartidos.'
                },
                {
                    id: 'cuidado_piel',
                    title: 'Cuidado de piel frágil',
                    summary: 'Higiene y protección de la piel en pacientes de edad avanzada',
                    materials: ['Emolientes', 'Guantes'],
                    steps: [
                        'Evaluar piel',
                        'Aplicar emolientes',
                        'Evitar fricciones'
                    ],
                    notes: 'Aumentar hidratación cutánea.'
                }
            ],
            curaciones: [
                {
                    id: 'curacion_simple',
                    title: 'Curación de herida simple',
                    summary: 'Cambio de apósito en heridas limpias.',
                    materials: ['Guantes', 'Solución salina', 'Gasas', 'Apósito estéril'],
                    steps: [
                        'Higiene',
                        'Retirar apósito',
                        'Irrigar',
                        'Aplicar apósito nuevo'
                    ],
                    notes: 'Registrar aspecto y exudado.'
                },
                {
                    id: 'curacion_escaras',
                    title: 'Curación de escaras',
                    summary: 'Manejo y alivio de presión.',
                    materials: ['Apósitos especiales', 'Colchón antiescaras'],
                    steps: [
                        'Evaluar estadío',
                        'Reposicionar cada 2h',
                        'Aplicar apósito especializado'
                    ],
                    notes: ''
                },
                {
                    id: 'curacion_quirurgica',
                    title: 'Curación postquirúrgica',
                    summary: 'Seguimiento de heridas operatorias.',
                    materials: ['Guantes estériles', 'Pinzas', 'Apósito'],
                    steps: [
                        'Comprobar sellado',
                        'Limpieza estéril',
                        'Registrar signos infección'
                    ],
                    notes: ''
                },
                {
                    id: 'curacion_valvula',
                    title: 'Cambio de apósito con drenaje',
                    summary: 'Cuidado en heridas con drenaje activo',
                    materials: ['EPP', 'Recipientes', 'apósitos adsorbentes'],
                    steps: [
                        'Evitar contaminación',
                        'Documentar volumen y aspecto'
                    ],
                    notes: ''
                },
                {
                    id: 'curacion_absceso',
                    title: 'Drenaje y curación de absceso',
                    summary: 'Drenaje y cuidados post-drenaje',
                    materials: ['Equipo estéril', 'Antiséptico'],
                    steps: [
                        'Valorar',
                        'Drenar por profesional',
                        'Curar y control'
                    ],
                    notes: 'Derivar si sospecha de celulitis.'
                }
            ],
            farmaco: [
                {
                    id: 'admin_oral',
                    title: 'Administración oral',
                    summary: 'Verificar 5 correctos antes de administrar',
                    materials: ['Prescripción', 'Hoja alergias'],
                    steps: [
                        'Identificar paciente',
                        'Comprobar fármaco/dosis/vía/hora',
                        'Administrar y registrar'
                    ],
                    notes: ''
                },
                {
                    id: 'admin_ev',
                    title: 'Administración EV (bolus)',
                    summary: 'Preparación y administración por vía venosa',
                    materials: ['Solución', 'Set EV', 'Aguja', 'Tubo'],
                    steps: [
                        'Verificar prescripción',
                        'Diluir si necesario',
                        'Administrar según velocidad',
                        'Observar reacciones'
                    ],
                    notes: 'Solo personal habilitado.'
                },
                {
                    id: 'oxigenoterapia',
                    title: 'Oxigenoterapia',
                    summary: 'Cánula nasal o mascarilla según indicación',
                    materials: ['Cánula', 'Mascarilla', 'Oxímetro'],
                    steps: [
                        'Verificar orden',
                        'Colocar dispositivo',
                        'Monitorizar SpO2'
                    ],
                    notes: ''
                },
                {
                    id: 'vacunas',
                    title: 'Administración de vacuna IM',
                    summary: 'Preparación estéril y registro de lote',
                    materials: ['Jeringa', 'Vacuna', 'Algodón', 'EPI'],
                    steps: [
                        'Verificar vacuna y lote',
                        'Administrar en sitio apropiado',
                        'Registrar lote y reacciones'
                    ],
                    notes: ''
                },
                {
                    id: 'dosis_peso',
                    title: 'Dosis según peso',
                    summary: 'Calcular dosis por kg ejemplo',
                    materials: ['Balanza', 'Calculadora'],
                    steps: [
                        'Calcular kg',
                        'Aplicar mg/kg'
                    ],
                    notes: 'Ejemplo 10 mg/kg como referencia no universal.'
                }
            ],
            emergencias: [
                {
                    id: 'rcp',
                    title: 'RCP básica (adulto)',
                    summary: 'Comprimir 100-120/min y 5-6 cm de profundidad',
                    materials: ['DEA si disponible'],
                    steps: [
                        'Seguridad',
                        'Comprobar respuesta',
                        'Llamar ayuda',
                        'Iniciar compresiones 30:2 o continuas según guía',
                        'Usar DEA'
                    ],
                    notes: ''
                },
                {
                    id: 'anafilaxia',
                    title: 'Manejo de anafilaxia',
                    summary: 'Reconocer y actuar rápido',
                    materials: ['Epinefrina IM', 'Oxígeno', 'Vía IV'],
                    steps: [
                        'Evaluar VA',
                        'Administrar epinefrina IM',
                        'Oxígeno y soporte'
                    ],
                    notes: 'Tras la dosis, monitorizar y repetir según protocolo.'
                },
                {
                    id: 'hemorragia',
                    title: 'Control de hemorragia',
                    summary: 'Compresión directa, torniquete si necesario',
                    materials: ['Gasas', 'Guantes', 'Torniquete'],
                    steps: [
                        'Comprimir',
                        'Elevar miembro',
                        'Transportar a urgencias'
                    ],
                    notes: ''
                },
                {
                    id: 'obstruccion_va',
                    title: 'Obstrucción de vía aérea (adulto)',
                    summary: 'Maniobra de Heimlich y cuidados',
                    materials: [],
                    steps: [
                        'Valorar capacidad de hablar',
                        'Heimlich si obstrucción completa',
                        'Si inconsciente iniciar RCP'
                    ],
                    notes: ''
                },
                {
                    id: 'sintomaticos',
                    title: 'Manejo inicial del síncope',
                    summary: 'Evaluar causas y medidas iniciales',
                    materials: [],
                    steps: [
                        'Posición supina',
                        'Abrir vía aérea',
                        'Monitorizar'
                    ],
                    notes: 'Buscar causa subyacente.'
                }
            ],
            movilizacion: [
                {
                    id: 'transferencia',
                    title: 'Transferencia segura',
                    summary: 'Uso de técnicas y dispositivos de ayuda',
                    materials: ['Cinturón traslado', 'Sábanas de deslizar'],
                    steps: [
                        'Evaluar',
                        'Explicar',
                        'Coordinar equipo',
                        'Usar ayudas mecánicas'
                    ],
                    notes: ''
                },
                {
                    id: 'posicionamiento',
                    title: 'Cambio de decúbito',
                    summary: 'Prevención de escaras mediante cambios posicionales',
                    materials: [],
                    steps: [
                        'Cambiar cada 2h',
                        'Registrar posición'
                    ],
                    notes: ''
                },
                {
                    id: 'ayuda_mec',
                    title: 'Uso de ayuda mecánica',
                    summary: 'Uso de grúa y tablas',
                    materials: ['Grúa', 'Equipo'],
                    steps: [
                        'Evaluar',
                        'Coordinación equipo',
                        'Seguridad paciente'
                    ],
                    notes: 'Formación previa necesaria.'
                }
            ],
            nutricion: [
                {
                    id: 'alimentacion_asistida',
                    title: 'Asistencia en alimentación',
                    summary: 'Prevención de aspiración',
                    materials: ['Texturas adaptadas'],
                    steps: [
                        'Valorar riesgo',
                        'Posicionar 45-90°',
                        'Supervisar ingestion'
                    ],
                    notes: ''
                },
                {
                    id: 'sonda_nasogastrica',
                    title: 'SNG - cuidado y administración',
                    summary: 'Cuidado de nutrición enteral',
                    materials: ['Sonda NG', 'Bomba nutricional'],
                    steps: [
                        'Comprobar posicion',
                        'Administrar por gravedad o bomba',
                        'Limpiar y fijar'
                    ],
                    notes: ''
                }
            ],
            infeccion: [
                {
                    id: 'aislamiento_contacto',
                    title: 'Precauciones por contacto',
                    summary: 'EPP y manejo de residuos',
                    materials: ['Guantes', 'Bata', 'Mascarilla'],
                    steps: [
                        'Determinar aislamiento',
                        'Colocar EPP',
                        'Retirar EPP correctamente',
                        'Limpiar superficies'
                    ],
                    notes: ''
                },
                {
                    id: 'control_infeccion_cateter',
                    title: 'Cuidados de catéter central',
                    summary: 'Mantener técnica estéril',
                    materials: ['EPP', 'Apósito estéril'],
                    steps: [
                        'Higiene de manos',
                        'Cambiar apósito según protocolo',
                        'Registrar signos infección'
                    ],
                    notes: ''
                }
            ]
        };
        
        // Enfermedades comunes
        const DISEASES = [
            {
                name: 'Neumonía',
                summary: 'Infección inflamatoria aguda del parénquima pulmonar, generalmente bacteriana o viral. Presenta fiebre, tos productiva, disnea y crepitaciones.'
            },
            {
                name: 'Insuficiencia cardíaca',
                summary: 'Incapacidad del corazón para bombear adecuadamente. Síntomas incluyen disnea, ortopnea, edema periférico y fatiga.'
            },
            {
                name: 'Diabetes mellitus',
                summary: 'Trastorno del metabolismo de la glucosa con hiperglucemia crónica. Tipos principales: tipo 1 (autoinmune) y tipo 2 (resistencia a insulina).'
            },
            {
                name: 'EPOC',
                summary: 'Enfermedad pulmonar obstructiva crónica con limitación al flujo aéreo progresiva. Caracterizada por tos crónica, esputo y disnea.'
            },
            {
                name: 'Sepsis',
                summary: 'Respuesta sistémica descontrolada a infección que puede llevar a disfunción orgánica. Requiere tratamiento inmediato con antibióticos y soporte.'
            },
            {
                name: 'ACV (Accidente cerebrovascular)',
                summary: 'Pérdida repentina de función neurológica por isquemia o hemorragia cerebral. Signos: debilidad facial, alteración del habla, pérdida de fuerza en un lado.'
            },
            {
                name: 'Úlcera péptica',
                summary: 'Lesión en la mucosa gástrica o duodenal. Causada por H. pylori o AINEs. Dolor epigástrico, náuseas, posible hemorragia digestiva.'
            },
            {
                name: 'Insuficiencia renal aguda',
                summary: 'Pérdida rápida de función renal con alteración de homeostasis. Caracterizada por oliguria, retención de metabolitos y alteraciones electrolíticas.'
            },
            {
                name: 'Hipertensión arterial',
                summary: 'Presión arterial persistentemente elevada (>140/90 mmHg). Factor de riesgo para enfermedad cardiovascular, ACV y nefropatía.'
            },
            {
                name: 'Cáncer de pulmón',
                summary: 'Neoplasia maligna más común y letal. Relacionado con tabaquismo. Síntomas: tos persistente, hemoptisis, pérdida de peso, disnea.'
            }
        ];
        
        // Medicamentos y combinaciones peligrosas
        const NEVER_COMBINE = [
            { a: 'warfarina', b: 'ibuprofeno', reason: 'Aumento del riesgo de hemorragia', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK545235/' },
            { a: 'paracetamol', b: 'alcohol', reason: 'Hepatotoxicidad severa', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK547703/' },
            { a: 'ciprofloxacina', b: 'antiácidos', reason: 'Disminución de absorción', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK538340/' },
            { a: 'metformina', b: 'contraste iodado', reason: 'Riesgo de acidosis láctica', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK537272/' },
            { a: 'sertralina', b: 'fenelzina', reason: 'Síndrome serotoninérgico', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK537281/' },
            { a: 'simvastatina', b: 'eritromicina', reason: 'Miopatía severa', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK537092/' },
            { a: 'gemfibrozil', b: 'statinas', reason: 'Rabdomiólisis', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK537290/' },
            { a: 'metotrexato', b: 'cotrimoxazol', reason: 'Mielosupresión', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK537276/' },
            { a: 'digoxina', b: 'verapamilo', reason: 'Bloqueo cardíaco', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK537278/' },
            { a: 'nitroglicerina', b: 'sildenafil', reason: 'Hipotensión severa', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK537279/' },
            { a: 'linezolid', b: 'sertralina', reason: 'Síndrome serotoninérgico', ref: 'https://www.ncbi.nlm.nih.gov/books/NBK537282/' }
        ];
        
        const MEDS = [
            'Warfarina', 'Ibuprofeno', 'Paracetamol', 'Ciprofloxacina', 'Metformina',
            'Sertralina', 'Omeprazol', 'Sildenafil', 'Nitroglicerina', 'Clopidogrel',
            'Digoxina', 'Verapamilo', 'Fenelzina (MAOI)', 'Sertralina (SSRI)', 
            'Contraste iodado', 'Simvastatina', 'Eritromicina', 'Gemfibrozil', 
            'Metotrexato', 'Linezolid'
        ];
        
        // Pacientes
        const PATIENTS = [
            {
                id: 1,
                nombre: 'María González',
                edad: 65,
                diagnosticoPrincipal: 'Diabetes mellitus tipo 2',
                especialidad: 'Endocrinología',
                riesgoCardiovascular: 'moderado',
                alergias: ['Penicilina'],
                historiaClinica: {
                    resumen: 'Paciente femenina de 65 años con diabetes tipo 2 diagnosticada hace 10 años.',
                    diagnosticos: [
                        { fecha: '2013-06-15', cie10: 'E11.9', descripcion: 'Diabetes mellitus tipo 2', estado: 'Crónico' },
                        { fecha: '2018-03-20', cie10: 'E78.0', descripcion: 'Hipercolesterolemia', estado: 'Crónico' }
                    ],
                    tratamientos: [
                        { fechaInicio: '2013-06-15', medicamento: 'Metformina', dosis: '850mg cada 12h', duracion: 'Continuo' },
                        { fechaInicio: '2018-03-20', medicamento: 'Atorvastatina', dosis: '20mg cada 24h', duracion: 'Continuo' }
                    ],
                    evolucion: [
                        { fecha: '2023-01-10', nota: 'HbA1c 7.2%. Buen control glucémico.' },
                        { fecha: '2023-07-15', nota: 'LDL 110 mg/dL. Ajuste de dosis de estatina.' }
                    ],
                    signosVitales: [
                        { fecha: '2023-01-10', temperatura: 36.5, pa: '130/80', fc: 78, fr: 16, spo2: 98, peso: 70, talla: 1.60, imc: 27.3 },
                        { fecha: '2023-07-15', temperatura: 36.7, pa: '128/78', fc: 76, fr: 14, spo2: 98, peso: 68, talla: 1.60, imc: 26.6 }
                    ],
                    controles: [
                        { tipo: 'HbA1c', cada: '3 meses', proximo: '2023-10-15' },
                        { tipo: 'Perfil lipídico', cada: '6 meses', proximo: '2024-01-15' }
                    ]
                }
            },
            {
                id: 2,
                nombre: 'Carlos Rodríguez',
                edad: 72,
                diagnosticoPrincipal: 'EPOC',
                especialidad: 'Neumología',
                riesgoCardiovascular: 'alto',
                alergias: [],
                historiaClinica: {
                    resumen: 'Paciente masculino de 72 años con EPOC grado III, exfumador de 40 paquetes-año.',
                    diagnosticos: [
                        { fecha: '2010-05-12', cie10: 'J44.9', descripcion: 'EPOC', estado: 'Crónico' },
                        { fecha: '2015-11-03', cie10: 'I20.9', descripcion: 'Angina de pecho', estado: 'Intermitente' }
                    ],
                    tratamientos: [
                        { fechaInicio: '2010-05-12', medicamento: 'Tiotropio', dosis: '18mcg cada 24h', duracion: 'Continuo' },
                        { fechaInicio: '2015-11-03', medicamento: 'Isosorbide', dosis: '20mg cada 12h', duracion: 'Continuo' }
                    ],
                    evolucion: [
                        { fecha: '2023-02-20', nota: 'Exacerbación leve de EPOC. Tratada con antibiótico y corticoide.' },
                        { fecha: '2023-08-10', nota: 'Función pulmonar estable. Continúa rehabilitación.' }
                    ],
                    signosVitales: [
                        { fecha: '2023-02-20', temperatura: 37.2, pa: '140/85', fc: 88, fr: 22, spo2: 92, peso: 65, talla: 1.70, imc: 22.5 },
                        { fecha: '2023-08-10', temperatura: 36.8, pa: '138/82', fc: 84, fr: 18, spo2: 94, peso: 66, talla: 1.70, imc: 22.8 }
                    ],
                    controles: [
                        { tipo: 'Espirometría', cada: '6 meses', proximo: '2024-02-10' },
                        { tipo: 'Control de oxigenoterapia', cada: '3 meses', proximo: '2023-11-10' }
                    ]
                }
            },
            {
                id: 3,
                nombre: 'Ana Martínez',
                edad: 48,
                diagnosticoPrincipal: 'VIH',
                especialidad: 'Infectología',
                riesgoCardiovascular: 'moderado',
                alergias: ['Sulfamidas'],
                historiaClinica: {
                    resumen: 'Paciente femenina de 48 años con VIH desde 2013, tratamiento antirretroviral efectivo.',
                    diagnosticos: [
                        { fecha: '2013-06-15', cie10: 'B20', descripcion: 'VIH', estado: 'Crónico' }
                    ],
                    tratamientos: [
                        { fechaInicio: '2013-06-15', medicamento: 'Dolutegravir', dosis: '50mg cada 24h', duracion: 'Continuo' }
                    ],
                    evolucion: [
                        { fecha: '2013-06-15', nota: 'Diagnóstico de VIH. Iniciado tratamiento antirretroviral.' },
                        { fecha: '2020-01-10', nota: 'Control viral indetectable desde hace 5 años.' },
                        { fecha: '2023-03-15', nota: 'Carga viral indetectable. CD4 650 células/mm³.' }
                    ],
                    signosVitales: [
                        { fecha: '2023-01-10', temperatura: 36.8, pa: '115/75', fc: 72, fr: 14, spo2: 98, peso: 62, talla: 1.60, imc: 24.2 },
                        { fecha: '2023-07-15', temperatura: 36.6, pa: '118/72', fc: 70, fr: 12, spo2: 99, peso: 63, talla: 1.60, imc: 24.6 }
                    ],
                    controles: [
                        { tipo: 'Carga Viral', cada: '6 meses', proximo: '2023-09-15' },
                        { tipo: 'Perfil Inmunológico', cada: '6 meses', proximo: '2023-09-15' }
                    ]
                }
            },
            {
                id: 4,
                nombre: 'Roberto Sánchez',
                edad: 67,
                diagnosticoPrincipal: 'Insuficiencia Cardíaca',
                especialidad: 'Cardiología',
                riesgoCardiovascular: 'alto',
                alergias: ['Ioduro'],
                historiaClinica: {
                    resumen: 'Paciente masculino de 67 años con IC por miocardiopatía isquémica.',
                    diagnosticos: [
                        { fecha: '2020-01-15', cie10: 'I50.9', descripcion: 'Insuficiencia Cardíaca', estado: 'Crónico' },
                        { fecha: '2020-01-15', cie10: 'I25.10', descripcion: 'Enfermedad arterial coronaria', estado: 'Crónico' }
                    ],
                    tratamientos: [
                        { fechaInicio: '2020-01-15', medicamento: 'Enalapril', dosis: '10mg cada 12h', duracion: 'Continuo' },
                        { fechaInicio: '2020-01-15', medicamento: 'Carvedilol', dosis: '25mg cada 12h', duracion: 'Continuo' },
                        { fechaInicio: '2020-01-15', medicamento: 'Furosemida', dosis: '40mg cada 24h', duracion: 'Continuo' }
                    ],
                    evolucion: [
                        { fecha: '2020-01-15', nota: 'IC clase III NYHA. Iniciado tratamiento.' },
                        { fecha: '2022-06-20', nota: 'Mejoría funcional. Clase II NYHA.' },
                        { fecha: '2023-05-10', nota: 'Estable. Control de peso diario.' }
                    ],
                    signosVitales: [
                        { fecha: '2020-01-15', temperatura: 36.9, pa: '150/90', fc: 92, fr: 20, spo2: 94, peso: 85, talla: 1.75, imc: 27.8 },
                        { fecha: '2023-05-10', temperatura: 36.7, pa: '128/78', fc: 76, fr: 14, spo2: 97, peso: 78, talla: 1.75, imc: 25.5 }
                    ],
                    controles: [
                        { tipo: 'Ecocardiograma', cada: '12 meses', proximo: '2024-05-10' },
                        { tipo: 'Perfil renal', cada: '6 meses', proximo: '2023-11-10' }
                    ]
                }
            }
        ];
        
        // Recursos educativos
        const RESOURCES = [
            {
                id: 1,
                titulo: 'Guía de RCP 2023',
                categoria: 'Guías',
                tipo: 'documento',
                url: 'https://example.com/rcp2023.pdf',
                etiquetas: ['RCP', 'emergencias', 'cardiología'],
                descripcion: 'Guía actualizada de reanimación cardiopulmonar según recomendaciones 2023.'
            },
            {
                id: 2,
                titulo: 'Video: Técnica de curación',
                categoria: 'Videos',
                tipo: 'video',
                url: 'https://example.com/curacion.mp4',
                etiquetas: ['curaciones', 'heridas', 'asepsia'],
                descripcion: 'Demostración de técnica correcta para curación de heridas simples.'
            },
            {
                id: 3,
                titulo: 'Imagen: Anatomía del corazón',
                categoria: 'Imágenes',
                tipo: 'imagen',
                url: 'https://placehold.co/600x400/orange/white?text=Anatom%C3%ADa+del+coraz%C3%B3n',
                etiquetas: ['cardiología', 'anatomía'],
                descripcion: 'Ilustración detallada de la anatomía cardíaca.'
            },
            {
                id: 4,
                titulo: 'Protocolo de diabetes',
                categoria: 'Protocolos',
                tipo: 'documento',
                url: 'https://example.com/diabetes.pdf',
                etiquetas: ['diabetes', 'endocrinología', 'protocolo'],
                descripcion: 'Protocolo de manejo de diabetes mellitus en atención primaria.'
            },
            {
                id: 5,
                titulo: 'Video: Administración de medicamentos EV',
                categoria: 'Videos',
                tipo: 'video',
                url: 'https://example.com/medicamentos_ev.mp4',
                etiquetas: ['farmacología', 'vía endovenosa'],
                descripcion: 'Técnica segura para la administración de medicamentos por vía endovenosa.'
            }
        ];
        
        // PAE almacenados
        const PAE_KEY = 'pae_records';
        
        // Content area and functions
        const contentArea = $('contentArea');
        const diseasePanel = $('diseasePanel');
        const diseaseResults = $('diseaseResults');
        const medCombo = $('medCombo');
        const paeForm = $('paeForm');
        const rcpGuide = $('rcpGuide');
        const calculadoras = $('calculadoras');
        const pacientes = $('pacientes');
        const recursos = $('recursos');
        
        function clearContent() {
            contentArea.innerHTML = '';
            diseasePanel.style.display = 'none';
            medCombo.style.display = 'none';
            paeForm.style.display = 'none';
            rcpGuide.style.display = 'none';
            calculadoras.style.display = 'none';
            pacientes.style.display = 'none';
            recursos.style.display = 'none';
            
            // Remove active state from all buttons
            document.querySelectorAll('.cat-btn').forEach(btn => {
                btn.classList.remove('active');
            });
        }
        
        function renderCategory(cat) {
            clearContent();
            
            // Add active state to the selected button
            document.querySelectorAll('.cat-btn').forEach(btn => {
                if (btn.getAttribute('data-cat') === cat) {
                    btn.classList.add('active');
                }
            });
            
            if (PROCEDURES[cat]) {
                const categoryCard = document.createElement('div');
                categoryCard.className = 'category-card';
                
                const h2 = document.createElement('h2');
                h2.innerHTML = `<i class="fas fa-folder-open"></i> ${getCatTitle(cat)}`;
                categoryCard.appendChild(h2);
                
                PROCEDURES[cat].forEach(proc => {
                    const procedure = document.createElement('div');
                    procedure.className = 'procedure';
                    
                    const h3 = document.createElement('h3');
                    h3.innerHTML = `<i class="fas fa-file-medical"></i> ${proc.title}`;
                    procedure.appendChild(h3);
                    
                    if (proc.summary) {
                        const summary = document.createElement('p');
                        summary.className = 'summary';
                        summary.innerHTML = `<i class="fas fa-info-circle"></i> ${proc.summary}`;
                        procedure.appendChild(summary);
                    }
                    
                    if (proc.materials && proc.materials.length > 0) {
                        const materials = document.createElement('div');
                        materials.className = 'materials';
                        
                        const materialsLabel = document.createElement('h4');
                        materialsLabel.innerHTML = `<i class="fas fa-box-open"></i> Materiales:`;
                        materials.appendChild(materialsLabel);
                        
                        const ul = document.createElement('ul');
                        proc.materials.forEach(mat => {
                            const li = document.createElement('li');
                            li.textContent = mat;
                            ul.appendChild(li);
                        });
                        materials.appendChild(ul);
                        procedure.appendChild(materials);
                    }
                    
                    if (proc.steps && proc.steps.length > 0) {
                        const steps = document.createElement('div');
                        steps.className = 'steps';
                        
                        const stepsLabel = document.createElement('h4');
                        stepsLabel.innerHTML = `<i class="fas fa-list-ol"></i> Pasos:`;
                        steps.appendChild(stepsLabel);
                        
                        const ol = document.createElement('ol');
                        ol.style.counterReset = 'step';
                        proc.steps.forEach(step => {
                            const li = document.createElement('li');
                            li.textContent = step;
                            ol.appendChild(li);
                        });
                        steps.appendChild(ol);
                        procedure.appendChild(steps);
                    }
                    
                    if (proc.notes) {
                        const notes = document.createElement('div');
                        notes.className = 'notes';
                        notes.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${proc.notes}`;
                        procedure.appendChild(notes);
                    }
                    
                    categoryCard.appendChild(procedure);
                });
                
                contentArea.appendChild(categoryCard);
            }
        }
        
        function getCatTitle(cat) {
            const titles = {
                'higiene': 'Procedimientos de Higiene',
                'curaciones': 'Curaciones y Heridas',
                'farmaco': 'Farmacología',
                'emergencias': 'Emergencias',
                'movilizacion': 'Movilización y Transferencia',
                'nutricion': 'Nutrición',
                'infeccion': 'Control de Infecciones',
                'medicamentos': 'Medicamentos',
                'enfermedades': 'Enfermedades',
                'pae': 'Plan de Atención de Enfermería',
                'rcp': 'Reanimación Cardiovascular',
                'calculadoras': 'Calculadoras Clínicas',
                'recursos': 'Recursos Educativos',
                'pacientes': 'Gestión de Pacientes'
            };
            return titles[cat] || cat;
        }
        
        // Event listeners for category buttons
        document.querySelectorAll('.cat-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const cat = btn.getAttribute('data-cat');
                
                if (cat === 'medicamentos') {
                    showMedCombo();
                } else if (cat === 'enfermedades') {
                    showDiseases();
                } else if (cat === 'pae') {
                    showPaeForm();
                } else if (cat === 'rcp') {
                    showRcpGuide();
                } else if (cat === 'calculadoras') {
                    showCalculadoras();
                } else if (cat === 'pacientes') {
                    showPacientes();
                } else if (cat === 'recursos') {
                    showRecursos();
                } else {
                    renderCategory(cat);
                }
            });
        });
        
        // Open all procedures
        $('openAllBtn').addEventListener('click', () => {
            clearContent();
            Object.keys(PROCEDURES).forEach(k => renderCategory(k));
        });
        
        // Global search
        $('searchBtn').addEventListener('click', () => {
            const q = $('globalSearch').value.trim().toLowerCase();
            if (!q) { 
                alert('Ingrese término de búsqueda'); 
                return; 
            }
            clearContent();
            
            const results = [];
            
            // Search procedures
            Object.keys(PROCEDURES).forEach(cat => {
                PROCEDURES[cat].forEach(proc => {
                    const hay = (proc.title + ' ' + proc.summary + ' ' + (proc.steps||[]).join(' ')).toLowerCase();
                    if (hay.includes(q)) {
                        results.push({cat, p: proc});
                    }
                });
            });
            
            // Search diseases
            const dHits = DISEASES.filter(d => (d.name + ' ' + d.summary).toLowerCase().includes(q));
            if (dHits.length) {
                const card = document.createElement('div');
                card.className = 'category-card';
                card.innerHTML = `<h2><i class="fas fa-notes-medical"></i> Enfermedades encontradas</h2>`;
                
                dHits.forEach(d => {
                    const diseaseItem = document.createElement('div');
                    diseaseItem.className = 'disease-item';
                    diseaseItem.innerHTML = `<strong>${d.name}</strong><div class="small">${d.summary}</div>`;
                    card.appendChild(diseaseItem);
                });
                
                contentArea.appendChild(card);
            }
            
            // Search medications
            const mHits = MEDS.filter(m => m.toLowerCase().includes(q));
            if (mHits.length) {
                const card = document.createElement('div');
                card.className = 'category-card';
                card.innerHTML = `<h2><i class="fas fa-pills"></i> Medicamentos encontrados</h2><div class="small">${mHits.join(', ')}</div>`;
                contentArea.appendChild(card);
            }
            
            // Search patients
            const pHits = PATIENTS.filter(p => p.nombre.toLowerCase().includes(q) || 
                p.diagnosticoPrincipal.toLowerCase().includes(q) || 
                p.especialidad.toLowerCase().includes(q));
            if (pHits.length) {
                const card = document.createElement('div');
                card.className = 'category-card';
                card.innerHTML = `<h2><i class="fas fa-users"></i> Pacientes encontrados</h2>`;
                
                pHits.forEach(p => {
                    const patientItem = document.createElement('div');
                    patientItem.className = 'disease-item';
                    patientItem.innerHTML = `<strong>${p.nombre}</strong><div class="small">Edad: ${p.edad}, Diagnóstico: ${p.diagnosticoPrincipal}, Especialidad: ${p.especialidad}</div>`;
                    card.appendChild(patientItem);
                });
                
                contentArea.appendChild(card);
            }
            
            // Show procedure results
            if (results.length > 0) {
                const card = document.createElement('div');
                card.className = 'category-card';
                card.innerHTML = `<h2><i class="fas fa-search"></i> Resultados de búsqueda</h2>`;
                
                results.forEach(r => {
                    const proc = r.p;
                    const procedure = document.createElement('div');
                    procedure.className = 'procedure';
                    
                    const h3 = document.createElement('h3');
                    h3.innerHTML = `<i class="fas fa-file-medical"></i> ${proc.title}`;
                    procedure.appendChild(h3);
                    
                    if (proc.summary) {
                        const summary = document.createElement('p');
                        summary.className = 'summary';
                        summary.innerHTML = `<i class="fas fa-info-circle"></i> ${proc.summary}`;
                        procedure.appendChild(summary);
                    }
                    
                    card.appendChild(procedure);
                });
                
                contentArea.appendChild(card);
            }
            
            if (results.length === 0 && dHits.length === 0 && mHits.length === 0 && pHits.length === 0) {
                const card = document.createElement('div');
                card.className = 'category-card';
                card.innerHTML = `<h2><i class="fas fa-exclamation-triangle"></i> No se encontraron resultados</h2><p>No se encontró información relacionada con "${q}". Intente con otro término de búsqueda.</p>`;
                contentArea.appendChild(card);
            }
        });
        
        // Show diseases
        function showDiseases() {
            clearContent();
            diseasePanel.style.display = 'block';
            diseaseResults.innerHTML = DISEASES.map(d => 
                `<div class="disease-item">
                    <strong>${d.name}</strong>
                    <div class="small">${d.summary}</div>
                </div>`
            ).join('');
        }
        
        // Show medication combinator
        function showMedCombo() {
            clearContent();
            medCombo.style.display = 'block';
            
            // Populate medication selects
            const medSelectA = $('medSelectA');
            const medSelectB = $('medSelectB');
            
            medSelectA.innerHTML = '<option value="">Seleccionar...</option>';
            medSelectB.innerHTML = '<option value="">Seleccionar...</option>';
            
            MEDS.forEach(med => {
                const optionA = document.createElement('option');
                optionA.value = med.toLowerCase();
                optionA.textContent = med;
                medSelectA.appendChild(optionA);
                
                const optionB = document.createElement('option');
                optionB.value = med.toLowerCase();
                optionB.textContent = med;
                medSelectB.appendChild(optionB);
            });
            
            // Populate never list
            $('neverList').innerHTML = NEVER_COMBINE.map(n => 
                `<div style="margin-bottom:10px;padding:8px;background:rgba(232,232,232,0.4);border-radius:8px">
                    <strong style="color:#c62828">${n.a} + ${n.b}</strong>
                    <div class="small">${n.reason} <a href="${n.ref}" target="_blank" rel="noopener" style="color:#1565c0"><i class="fas fa-external-link-alt"></i></a></div>
                </div>`
            ).join('');
            
            // Med search quick fill
            $('medSearchBox').addEventListener('input', (e) => {
                const q = e.target.value.trim().toLowerCase();
                if (!q) return;
                const matches = MEDS.filter(m => m.toLowerCase().includes(q));
                if (matches.length) {
                    $('medSelectA').value = matches[0].toLowerCase();
                    $('medSelectB').value = matches[1]?.toLowerCase() || matches[0].toLowerCase();
                }
            });
        }
        
        // Check medication interactions
        $('checkInteractionsBtn').addEventListener('click', () => {
            const a = $('medSelectA').value.toLowerCase();
            const b = $('medSelectB').value.toLowerCase();
            const out = $('medAlert');
            
            if (!a || !b) {
                out.innerHTML = '<div class="interactions-warning danger"><i class="fas fa-exclamation-triangle"></i> <span>Seleccione dos fármacos</span></div>';
                return;
            }
            
            if (a === b) {
                out.innerHTML = '<div class="interactions-warning success"><i class="fas fa-check-circle"></i> <span>Mismo medicamento seleccionado — cuidado con duplicidad terapéutica.</span></div>';
                return;
            }
            
            const hits = NEVER_COMBINE.filter(n => 
                (a.includes(n.a) && b.includes(n.b)) || 
                (a.includes(n.b) && b.includes(n.a))
            );
            
            if (hits.length) {
                out.innerHTML = `
                    <div class="interactions-warning danger">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Interacciones Peligrosas Detectadas:</strong>
                            <ul class="interactions-list">
                                ${hits.map(h => `<li><strong>${h.reason}</strong> (${h.a.toUpperCase()} + ${h.b.toUpperCase()}) <a href="${h.ref}" target="_blank" rel="noopener"><i class="fas fa-external-link-alt"></i></a></li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            } else {
                out.innerHTML = '<div class="interactions-warning success"><i class="fas fa-check-circle"></i> <span>No se detectaron interacciones peligrosas conocidas entre estos medicamentos.</span></div>';
            }
        });
        
        // Show PAE form
        function showPaeForm() {
            clearContent();
            paeForm.style.display = 'block';
        }
        
        // Generate PAE
        $('generatePaeBtn').addEventListener('click', () => {
            const patientName = $('patientName').value;
            const patientAge = $('patientAge').value;
            const diagnosis = $('diagnosis').value;
            const nursingDiagnosis = $('nursingDiagnosis').value;
            const goals = $('goals').value;
            const interventions = $('interventions').value;
            
            if (!patientName || !patientAge || !diagnosis || !nursingDiagnosis || !goals || !interventions) {
                alert('Por favor, complete todos los campos del PAE.');
                return;
            }
            
            clearContent();
            
            const paeCard = document.createElement('div');
            paeCard.className = 'category-card';
            paeCard.innerHTML = `
                <h2><i class="fas fa-clipboard-list"></i> Plan de Atención de Enfermería (PAE)</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> Paciente:</label>
                        <p>${patientName}, ${patientAge} años</p>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-diagnoses"></i> Diagnóstico Médico:</label>
                        <p>${diagnosis}</p>
                    </div>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-stethoscope"></i> Diagnóstico de Enfermería:</label>
                    <p>${$('nursingDiagnosis').options[$('nursingDiagnosis').selectedIndex].text}</p>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-bullseye"></i> Objetivos:</label>
                        <p>${goals}</p>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-hand-holding-medical"></i> Intervenciones:</label>
                        <p>${interventions}</p>
                    </div>
                </div>
                <div class="form-group">
                    <label><i class="far fa-calendar-alt"></i> Fecha:</label>
                    <p>${new Date().toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                </div>
                <div style="margin-top:20px;text-align:center;">
                    <button id="printPaeBtn" class="btn primary">
                        <i class="fas fa-print"></i> Imprimir PAE
                    </button>
                </div>
            `;
            
            contentArea.appendChild(paeCard);
            
            // Print functionality
            $('printPaeBtn').addEventListener('click', () => {
                window.print();
            });
        });
        
        // Save PAE
        $('savePaeBtn').addEventListener('click', () => {
            const name = $('pae_name').value.trim();
            const diag = $('pae_diag').value.trim();
            const plan = $('pae_plan').value.trim();
            
            if (!name || !diag) {
                $('paeMsg').textContent = 'Nombre y diagnóstico requeridos';
                setTimeout(() => $('paeMsg').textContent='', 2000);
                return;
            }
            
            const arr = JSON.parse(localStorage.getItem(PAE_KEY) || '[]');
            arr.push({name, diag, plan, ts: Date.now()});
            localStorage.setItem(PAE_KEY, JSON.stringify(arr));
            $('paeMsg').textContent = 'PAE guardado localmente';
            setTimeout(() => $('paeMsg').textContent='', 2000);
        });
        
        // Export PAE
        $('exportPaeBtn').addEventListener('click', () => {
            const arr = JSON.parse(localStorage.getItem(PAE_KEY) || '[]');
            if (arr.length === 0) {
                $('paeMsg').textContent = 'No hay PAEs guardados para exportar';
                setTimeout(() => $('paeMsg').textContent='', 2000);
                return;
            }
            
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(arr, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "pae_records.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            $('paeMsg').textContent = 'PAEs exportados';
            setTimeout(() => $('paeMsg').textContent='', 2000);
        });
        
        // Show RCP guide
        function showRcpGuide() {
            clearContent();
            rcpGuide.style.display = 'block';
        }
        
        // RCP timer
        let rcpInterval = null;
        let rcpSeconds = 0;
        
        function startRCP() {
            if (rcpInterval) return;
            rcpSeconds = 0;
            rcpInterval = setInterval(() => {
                rcpSeconds++;
                const mm = String(Math.floor(rcpSeconds/60)).padStart(2,'0');
                const ss = String(rcpSeconds%60).padStart(2,'0');
                $('rcpTimer').textContent = `${mm}:${ss}`;
                if(rcpSeconds % 120 === 0) {
                    if(navigator.vibrate) navigator.vibrate([200,100,200]);
                    alert('Cambio de reanimador recomendado (cada 2 min).');
                }
            }, 1000);
            $('rcpState').textContent='Estado: iniciado';
        }
        
        function stopRCP() {
            if(rcpInterval) clearInterval(rcpInterval);
            rcpInterval = null;
            $('rcpState').textContent='Estado: detenido';
            $('rcpTimer').textContent='00:00';
        }
        
        $('rcpStart').addEventListener('click', startRCP);
        $('rcpStop').addEventListener('click', stopRCP);
        
        // Show calculadoras
        function showCalculadoras() {
            clearContent();
            calculadoras.style.display = 'grid';
        }
        
        // Calculate IMC
        $('calculateImc').addEventListener('click', () => {
            const weight = parseFloat($('imc_weight').value);
            const height = parseFloat($('imc_height').value) / 100;
            
            if (!weight || !height) {
                $('imc-result').style.display = 'none';
                return;
            }
            
            const imc = weight / (height * height);
            let category = '';
            
            if (imc < 18.5) category = 'Bajo peso';
            else if (imc < 25) category = 'Peso normal';
            else if (imc < 30) category = 'Sobrepeso';
            else if (imc < 35) category = 'Obesidad grado I';
            else if (imc < 40) category = 'Obesidad grado II';
            else category = 'Obesidad grado III';
            
            $('imc-value').textContent = imc.toFixed(2);
            $('imc-category').textContent = category;
            $('imc-result').style.display = 'block';
        });
        
        // Calculate Filtration
        $('calculateFiltration').addEventListener('click', () => {
            const creatinine = parseFloat($('creatinine').value);
            const age = parseInt($('age').value);
            const sex = document.querySelector('input[name="sex"]:checked')?.value;
            
            if (!creatinine || !age || !sex) {
                $('filtration-result').style.display = 'none';
                return;
            }
            
            // Fórmula CKD-EPI
            let k, a, sexFactor;
            if (sex === 'female') {
                k = 0.7;
                a = creatinine <= 0.7 ? -0.241 : -1.2;
                sexFactor = 1.018;
            } else {
                k = 0.9;
                a = creatinine <= 0.9 ? -0.302 : -1.2;
                sexFactor = 1;
            }
            
            const eGFR = 141 * Math.pow(Math.min(creatinine/k, 1), a) * 
                        Math.pow(Math.max(creatinine/k, 1), -1.209) * 
                        Math.pow(0.993, age) * sexFactor;
            
            let category = '';
            if (eGFR >= 90) category = 'Normal o aumentado';
            else if (eGFR >= 60) category = 'Levemente disminuido';
            else if (eGFR >= 30) category = 'Moderadamente disminuido';
            else if (eGFR >= 15) category = 'Severamente disminuido';
            else category = 'Insuficiencia renal';
            
            $('filtration-value').textContent = Math.round(eGFR) + ' ml/min/1.73m²';
            $('filtration-category').textContent = category;
            $('filtration-result').style.display = 'block';
        });
        
        // Calculate SCORE
        $('calculateScore').addEventListener('click', () => {
            const age = parseInt($('score_age').value);
            const totalCholesterol = parseFloat($('total-cholesterol').value);
            const hdlCholesterol = parseFloat($('hdl-cholesterol').value);
            const systolicPressure = parseInt($('systolic-pressure').value);
            const smoker = $('smoker').checked;
            const diabetes = $('diabetes').checked;
            
            if (!age || !totalCholesterol || !hdlCholesterol || !systolicPressure) {
                $('score-result').style.display = 'none';
                return;
            }
            
            // Fórmula SCORE simplificada (aproximación)
            let score = 0;
            
            // Factores de riesgo
            if (age >= 70) score += 3;
            else if (age >= 60) score += 2;
            else if (age >= 50) score += 1;
            
            if (totalCholesterol >= 280) score += 3;
            else if (totalCholesterol >= 240) score += 2;
            else if (totalCholesterol >= 200) score += 1;
            
            if (hdlCholesterol < 35) score += 2;
            else if (hdlCholesterol < 40) score += 1;
            
            if (systolicPressure >= 180) score += 3;
            else if (systolicPressure >= 160) score += 2;
            else if (systolicPressure >= 140) score += 1;
            
            if (smoker) score += 2;
            if (diabetes) score += 2;
            
            let category = '';
            if (score < 5) category = 'Bajo riesgo (<1%)';
            else if (score < 10) category = 'Riesgo bajo (1-2%)';
            else if (score < 15) category = 'Riesgo moderado (3-5%)';
            else if (score < 20) category = 'Riesgo alto (6-10%)';
            else category = 'Riesgo muy alto (>10%)';
            
            $('score-value').textContent = score + ' puntos';
            $('score-category').textContent = category;
            $('score-result').style.display = 'block';
        });
        
        // Show pacientes
        function showPacientes() {
            clearContent();
            pacientes.style.display = 'block';
            updatePatientGrid();
        }
        
        // Update patient grid
        function updatePatientGrid() {
            const container = $('patients-container');
            const search = $('patient-search').value.toLowerCase();
            const specialty = $('patient-specialty').value;
            
            const filteredPatients = PATIENTS.filter(p => {
                const matchesSearch = !search || p.nombre.toLowerCase().includes(search) || 
                                    p.diagnosticoPrincipal.toLowerCase().includes(search);
                const matchesSpecialty = !specialty || p.especialidad === specialty;
                return matchesSearch && matchesSpecialty;
            });
            
            if (filteredPatients.length === 0) {
                container.innerHTML = '<p class="small">No se encontraron pacientes.</p>';
                return;
            }
            
            container.innerHTML = filteredPatients.map(p => 
                `<div class="patient-card">
                    <h3><i class="fas fa-user"></i> ${p.nombre}</h3>
                    <p><i class="fas fa-birthday-cake"></i> Edad: ${p.edad} años</p>
                    <p><i class="fas fa-diagnoses"></i> Diagnóstico: ${p.diagnosticoPrincipal}</p>
                    <p><i class="fas fa-stethoscope"></i> Especialidad: ${p.especialidad}</p>
                    <p><i class="fas fa-heartbeat"></i> Riesgo cardiovascular: ${p.riesgoCardiovascular}</p>
                    <p><i class="fas fa-allergies"></i> Alergias: ${p.alergias.length > 0 ? p.alergias.join(', ') : 'Ninguna'}</p>
                </div>`
            ).join('');
        }
        
        // Patient search
        $('patient-search').addEventListener('input', updatePatientGrid);
        $('patient-specialty').addEventListener('change', updatePatientGrid);
        
        // Add patient button
        $('addPatientBtn').addEventListener('click', () => {
            alert('Funcionalidad de agregar paciente disponible en versión completa con backend.');
        });
        
        // Show recursos
        function showRecursos() {
            clearContent();
            recursos.style.display = 'block';
            updateResourceCards();
        }
        
        // Update resource cards
        function updateResourceCards() {
            const container = $('resources-container');
            const search = $('resource-search').value.toLowerCase();
            const category = $('resource-category').value;
            
            const filteredResources = RESOURCES.filter(r => {
                const matchesSearch = !search || r.titulo.toLowerCase().includes(search) || 
                                    r.etiquetas.some(tag => tag.toLowerCase().includes(search));
                const matchesCategory = !category || r.categoria === category;
                return matchesSearch && matchesCategory;
            });
            
            if (filteredResources.length === 0) {
                container.innerHTML = '<p class="small">No se encontraron recursos.</p>';
                return;
            }
            
            container.innerHTML = filteredResources.map(r => 
                `<div class="resource-card">
                    <h3><i class="fas fa-book"></i> ${r.titulo}</h3>
                    <p><i class="fas fa-tags"></i> Categoría: ${r.categoria}</p>
                    <p><i class="fas fa-file"></i> Tipo: ${r.tipo}</p>
                    <p><i class="fas fa-tags"></i> Etiquetas: ${r.etiquetas.join(', ')}</p>
                    <p>${r.descripcion}</p>
                    <a href="${r.url}" target="_blank" class="btn primary" style="margin-top:10px;">
                        <i class="fas fa-external-link-alt"></i> Abrir Recurso
                    </a>
                </div>`
            ).join('');
        }
        
        // Resource search
        $('resource-search').addEventListener('input', updateResourceCards);
        $('resource-category').addEventListener('change', updateResourceCards);
        
        // Add resource button
        $('addResourceBtn').addEventListener('click', () => {
            alert('Funcionalidad de agregar recurso disponible en versión completa con backend.');
        });
        
        // Wikipedia search
        $('wikiFetchBtn').addEventListener('click', async () => {
            const q = $('globalSearch').value.trim();
            if(!q) { 
                alert('Escriba término en la búsqueda (ej: neumonía)'); 
                return; 
            }
            $('wikiOutput').textContent = 'Buscando en Wikipedia...';
            try {
                const url = `https://es.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(q)}`;
                const res = await fetch(url);
                if(!res.ok) { 
                    $('wikiOutput').textContent = 'No encontrado en Wikipedia.';
                    return; 
                }
                const data = await res.json();
                $('wikiOutput').innerHTML = `<strong>${data.title}</strong><div class="small">${data.extract}</div><div style="margin-top:8px"><a href="${data.content_urls?.desktop?.page||'#'}" target="_blank" class="btn small"><i class="fas fa-external-link-alt"></i> Leer en Wikipedia</a></div>`;
                diseasePanel.style.display = 'block';
            } catch(e) {
                $('wikiOutput').textContent = 'Error al buscar en Wikipedia.';
            }
        });
        
        // Quick action buttons
        $('quickRcpCard').addEventListener('click', () => {
            document.querySelector('[data-cat="rcp"]').click();
        });
        
        $('quickMedCard').addEventListener('click', () => {
            document.querySelector('[data-cat="medicamentos"]').click();
        });
        
        $('quickPaeCard').addEventListener('click', () => {
            document.querySelector('[data-cat="pae"]').click();
        });
        
        // Add keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl/Cmd + F for search focus
            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                e.preventDefault();
                $('globalSearch').focus();
            }
            
            // Escape to clear search
            if (e.key === 'Escape') {
                $('globalSearch').value = '';
            }
        });
        
        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            // Set initial state
            clearContent();
            
            // Add welcome message
            const welcomeCard = document.createElement('div');
            welcomeCard.className = 'category-card';
            welcomeCard.innerHTML = `
                <h2><i class="fas fa-home"></i> Bienvenido a Enfermería DAVID</h2>
                <p>Seleccione una categoría del menú lateral para acceder a procedimientos, guías clínicas, combinador de fármacos, enfermedades y más.</p>
                <p>Esta aplicación proporciona acceso rápido a información esencial para profesionales de enfermería y salud.</p>
                
                <div class="welcome-actions">
                    <div class="welcome-card" id="quickRcpCard">
                        <i class="fas fa-heartbeat"></i>
                        <h3>Guía Rápida de RCP</h3>
                        <p>Acceda rápidamente a los pasos esenciales de la reanimación cardiopulmonar</p>
                    </div>
                    <div class="welcome-card" id="quickMedCard">
                        <i class="fas fa-prescription-bottle-alt"></i>
                        <h3>Combinador de Fármacos</h3>
                        <p>Verifique interacciones medicamentosas peligrosas en segundos</p>
                    </div>
                    <div class="welcome-card" id="quickPaeCard">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>Crear PAE</h3>
                        <p>Genere planes de atención de enfermería personalizados</p>
                    </div>
                </div>
            `;
            contentArea.appendChild(welcomeCard);
            
            // Initialize quick action buttons
            $('quickRcpCard').addEventListener('click', () => {
                document.querySelector('[data-cat="rcp"]').click();
            });
            
            $('quickMedCard').addEventListener('click', () => {
                document.querySelector('[data-cat="medicamentos"]').click();
            });
            
            $('quickPaeCard').addEventListener('click', () => {
                document.querySelector('[data-cat="pae"]').click();
            });
        });
    </script>
</body>
</html>
