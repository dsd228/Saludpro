```html
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SaludPro v6.0 - Inteligencia Cl√≠nica Avanzada</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
  <style>
    :root {
      --primary-blue: #1a73e8;
      --primary-blue-lighter: #4285f4;
      --warning-yellow: #f9ab00;
      --alert-red: #ea4335;
      --accent-teal: #00897b;
      --accent-purple: #7b1fa2;
      --background-light: #f8f9fa;
      --background-dark: #1e1e1e;
      --text-dark: #202124;
      --text-light: #ffffff;
      --text-muted: #5f6368;
      --border-radius: 8px;
      --shadow-small: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      --shadow-medium: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
      --shadow-large: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);
      --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
      --transition-fast: all 0.2s ease-in-out;
      --transition-slow: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --z-modal: 1000;
      --status-success: #34a853;
      --status-warning: #f9ab00;
      --status-error: #ea4335;
      --status-info: #1a73e8;
    }

    .theme-dark {
      --background-light: #1e1e1e;
      --background-dark: #121212;
      --text-dark: #e0e0e0;
      --text-muted: #b0b0b0;
      --primary-blue-lighter: #1a237e;
    }

    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      background-color: var(--background-light);
      color: var(--text-dark);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      line-height: 1.6;
      overflow-x: hidden;
      transition: var(--transition-slow);
    }

    h1, h2, h3, h4, h5, h6 {
      margin: 0 0 15px 0;
      color: var(--text-dark);
      font-weight: 500;
    }

    h1 { font-size: 2.5em; }
    h2 { font-size: 2em; }
    h3 { font-size: 1.7em; }
    h4 { font-size: 1.5em; }
    h5 { font-size: 1.2em; }
    h6 { font-size: 1em; }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    header {
      background-color: var(--primary-blue);
      color: white;
      padding: 15px 0;
      box-shadow: var(--shadow-medium);
      position: sticky;
      top: 0;
      z-index: var(--z-header);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.5em;
      font-weight: 700;
    }

    .logo span {
      color: var(--warning-yellow);
    }

    nav ul {
      display: flex;
      list-style: none;
      gap: 20px;
      margin: 0;
      padding: 0;
    }

    nav ul li a {
      color: white;
      text-decoration: none;
      padding: 8px 12px;
      border-radius: var(--border-radius);
      transition: var(--transition-fast);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    nav ul li a:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    nav ul li a.active {
      background-color: rgba(255, 255, 255, 0.3);
      font-weight: 500;
    }

    main {
      flex-grow: 1;
      padding: 20px 0;
    }

    .page {
      display: none;
      padding: 20px;
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-medium);
      margin-top: 20px;
      animation: fadeIn 0.5s ease-out;
      min-height: 500px;
    }

    .page.active {
      display: block;
    }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }

    .page-header h2 {
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--primary-blue);
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: var(--border-radius);
      font-size: 1em;
      cursor: pointer;
      transition: var(--transition-fast);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background-color: var(--primary-blue);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--primary-blue-lighter);
    }

    .btn-secondary {
      background-color: var(--text-muted);
      color: white;
    }

    .btn-secondary:hover {
      background-color: #777;
    }

    .btn-warning {
      background-color: var(--warning-yellow);
      color: var(--text-dark);
    }

    .btn-warning:hover {
      background-color: #f09300;
    }

    .btn-danger {
      background-color: var(--alert-red);
      color: white;
    }

    .btn-danger:hover {
      background-color: #d32f2f;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: var(--text-dark);
    }

    .form-control {
      width: 100%;
      padding: 10px 15px;
      border: 1px solid #ccc;
      border-radius: var(--border-radius);
      font-size: 1em;
      transition: var(--transition-fast);
    }

    .form-control:focus {
      outline: none;
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
    }

    .form-row {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .form-row .form-group {
      flex: 1;
      min-width: 200px;
    }

    .card {
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-small);
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid #eee;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .card-title {
      margin: 0;
      color: var(--primary-blue);
      font-size: 1.3em;
      font-weight: 500;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid #eee;
      margin-bottom: 20px;
    }

    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: var(--transition-fast);
      font-weight: 500;
      color: var(--text-muted);
    }

    .tab.active {
      border-bottom-color: var(--primary-blue);
      color: var(--primary-blue);
      font-weight: 600;
    }

    .tab:hover {
      color: var(--primary-blue);
      background-color: rgba(26, 115, 232, 0.05);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* Consultorio Virtual */
    .consultorio-container {
      background-color: var(--background-light);
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: var(--shadow-medium);
    }

    .search-box {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }

    .search-box input {
      flex-grow: 1;
      padding: 12px 15px;
      border-radius: var(--border-radius);
      border: 1px solid #ccc;
      font-size: 1em;
      transition: var(--transition-fast);
    }

    .search-box input:focus {
      outline: none;
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
    }

    .search-box button {
      padding: 12px 20px;
      background-color: var(--primary-blue);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      cursor: pointer;
      font-size: 1em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .search-box button:hover {
      background-color: var(--primary-blue-lighter);
    }

    .suggestions {
      position: absolute;
      background: white;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      max-height: 200px;
      overflow-y: auto;
      width: 100%;
      box-shadow: var(--shadow-large);
      z-index: 1000;
      margin-top: 1px;
    }

    .suggestion-item {
      padding: 10px 15px;
      cursor: pointer;
      border-bottom: 1px solid #eee;
      transition: var(--transition-fast);
    }

    .suggestion-item:hover {
      background-color: #f5f5f5;
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .highlight {
      background-color: #fffacd;
      font-weight: bold;
    }

    .diagnostic-result {
      padding: 15px;
      border-radius: var(--border-radius);
      margin-bottom: 15px;
      background-color: white;
      border: 1px solid #eee;
      box-shadow: var(--shadow-small);
    }

    .diagnostic-result h4 {
      margin: 0 0 10px 0;
      color: var(--text-dark);
    }

    .progress-bar {
      width: 100%;
      height: 10px;
      background-color: #eee;
      border-radius: 5px;
      overflow: hidden;
      margin: 10px 0;
    }

    .progress {
      height: 100%;
      background-color: var(--primary-blue);
      border-radius: 5px;
      transition: width 0.5s ease;
    }

    .severity-high {
      color: var(--alert-red);
      font-weight: 600;
    }

    .severity-moderate {
      color: var(--warning-yellow);
      font-weight: 600;
    }

    .severity-low {
      color: var(--status-success);
      font-weight: 600;
    }

    .alert-card {
      display: flex;
      align-items: center;
      background-color: var(--warning-yellow);
      color: var(--text-dark);
      padding: 15px;
      border-radius: var(--border-radius);
      margin-bottom: 20px;
      box-shadow: var(--shadow-medium);
      border-left: 5px solid var(--alert-red);
    }

    .alert-card.info {
      background-color: #e3f2fd;
      border-left-color: var(--primary-blue);
    }

    .alert-card.success {
      background-color: #e8f5e8;
      border-left-color: var(--status-success);
    }

    .alert-icon {
      font-size: 2em;
      margin-right: 15px;
    }

    .recommendation {
      background-color: #f8f9fa;
      border-left: 4px solid var(--primary-blue);
      padding: 10px 15px;
      margin: 10px 0;
      border-radius: 0 4px 4px 0;
    }

    /* Calendario */
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 1px;
      background-color: #eee;
      border-radius: var(--border-radius);
      overflow: hidden;
      margin-bottom: 20px;
    }

    .calendar-header {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      background-color: var(--primary-blue);
      color: white;
      text-align: center;
      font-weight: 500;
    }

    .calendar-header div {
      padding: 10px;
    }

    .calendar-day {
      background-color: white;
      padding: 10px;
      min-height: 100px;
      position: relative;
    }

    .day-number {
      font-weight: 500;
      margin-bottom: 5px;
    }

    .appointment {
      background-color: var(--primary-blue);
      color: white;
      padding: 5px;
      border-radius: 4px;
      font-size: 0.8em;
      margin-bottom: 3px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .waiting-room {
      background-color: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-medium);
      overflow: hidden;
    }

    .waiting-room table {
      width: 100%;
      border-collapse: collapse;
    }

    .waiting-room th {
      background-color: var(--primary-blue);
      color: white;
      text-align: left;
      padding: 15px;
    }

    .waiting-room td {
      padding: 12px 15px;
      border-bottom: 1px solid #eee;
    }

    .waiting-time.high {
      color: var(--alert-red);
      font-weight: 600;
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: var(--z-modal);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal {
      background-color: white;
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      animation: slideIn 0.4s ease-out forwards;
      position: relative;
      border: 1px solid rgba(0,0,0,0.1);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #eee;
      padding: 15px 20px;
    }

    .modal-header h2 {
      margin: 0;
      color: var(--text-dark);
      font-size: 1.5em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .modal-close-btn {
      background: none;
      border: none;
      font-size: 1.5em;
      color: #888;
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .modal-close-btn:hover {
      color: var(--alert-red);
    }

    .modal-body {
      padding: 20px;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      padding: 15px 20px;
      border-top: 1px solid #eee;
      background-color: #f5f5f5;
      border-radius: 0 0 var(--border-radius) var(--border-radius);
    }

    @keyframes slideIn {
      from {
        transform: translateY(-50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    /* Notificaciones */
    .notification-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .notification {
      padding: 15px 20px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-medium);
      display: flex;
      align-items: center;
      gap: 10px;
      color: white;
      min-width: 300px;
      animation: slideInRight 0.3s ease-out;
    }

    .notification.success {
      background-color: var(--status-success);
    }

    .notification.warning {
      background-color: var(--warning-yellow);
      color: var(--text-dark);
    }

    .notification.error {
      background-color: var(--status-error);
    }

    .notification.info {
      background-color: var(--primary-blue);
    }

    @keyframes slideInRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }

      nav ul {
        flex-wrap: wrap;
        justify-content: center;
      }

      .form-row {
        flex-direction: column;
      }

      .form-row .form-group {
          min-width: 100%;
      }

      .calendar {
        grid-template-columns: repeat(1, 1fr);
      }

      .calendar-header {
        display: none;
      }

      .modal {
        width: 95%;
        margin: 10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo">
        <span class="material-symbols-outlined">medical_information</span>
        Salud<span>Pro</span> v6.0
      </div>
      <nav>
        <ul>
          <li><a href="#" class="active" onclick="navigateTo('dashboard')"><span class="material-symbols-outlined">dashboard</span>Dashboard</a></li>
          <li><a href="#" onclick="navigateTo('consultorio')"><span class="material-symbols-outlined">healing</span>Consultorio</a></li>
          <li><a href="#" onclick="navigateTo('appointments')"><span class="material-symbols-outlined">event</span>Citas</a></li>
          <li><a href="#" onclick="navigateTo('pharmacy')"><span class="material-symbols-outlined">local_pharmacy</span>Farmacia</a></li>
          <li><a href="#" onclick="toggleTheme()"><span class="material-symbols-outlined">dark_mode</span>Tema</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container">
    <!-- Dashboard -->
    <section id="dashboard" class="page active">
      <div class="page-header">
        <h2><span class="material-symbols-outlined">dashboard</span>Dashboard</h2>
        <div>
          <span class="material-symbols-outlined">calendar_today</span>
          <span id="current-date">12 de abril de 2025</span>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><span class="material-symbols-outlined">groups</span>Pacientes Recientes</h3>
          <button class="btn btn-primary" onclick="navigateTo('consultorio')">
            <span class="material-symbols-outlined">add</span>Nuevo Paciente
          </button>
        </div>
        <div class="patient-list">
          <table style="width: 100%; border-collapse: collapse;">
            <thead>
              <tr style="background-color: #f5f5f5; border-bottom: 2px solid #eee;">
                <th style="padding: 12px; text-align: left;">Nombre</th>
                <th style="padding: 12px; text-align: left;">Edad</th>
                <th style="padding: 12px; text-align: left;">Diagn√≥stico</th>
                <th style="padding: 12px; text-align: left;">Acciones</th>
              </tr>
            </thead>
            <tbody id="patient-list-body">
              <!-- Se llenar√° con JavaScript -->
            </tbody>
          </table>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><span class="material-symbols-outlined">event</span>Pr√≥ximas Citas</h3>
        </div>
        <div id="upcoming-appointments">
          <!-- Se llenar√° con JavaScript -->
        </div>
      </div>
    </section>

    <!-- Consultorio Virtual -->
    <section id="consultorio" class="page">
      <div class="page-header">
        <h2><span class="material-symbols-outlined">healing</span>Consultorio Virtual</h2>
        <button class="btn btn-secondary" onclick="navigateTo('dashboard')">
          <span class="material-symbols-outlined">arrow_back</span>Volver
        </button>
      </div>

      <div class="consultorio-container">
        <div class="search-box">
          <input type="text" id="patient-search" placeholder="Buscar paciente..." oninput="searchPatients()">
          <button onclick="openPatientSearchModal()"><span class="material-symbols-outlined">search</span>Buscar</button>
        </div>

        <div id="active-patient-info" style="margin-bottom: 20px; padding: 15px; background-color: #e3f2fd; border-radius: var(--border-radius); display: none;">
          <h3 id="active-patient-name"></h3>
          <p><strong>Edad:</strong> <span id="active-patient-age"></span> | <strong>Diagn√≥stico:</strong> <span id="active-patient-diagnosis"></span></p>
        </div>

        <div class="tabs">
          <div class="tab active" onclick="switchTab('diagnosis')">Diagn√≥stico Diferencial</div>
          <div class="tab" onclick="switchTab('vitals')">Signos Vitales</div>
          <div class="tab" onclick="switchTab('prescriptions')">Recetas</div>
          <div class="tab" onclick="switchTab('orders')">√ìrdenes</div>
        </div>

        <div id="diagnosis-tab" class="tab-content active">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title"><span class="material-symbols-outlined">psychology</span>Asistente de Diagn√≥stico Diferencial</h3>
            </div>
            <div class="form-group">
              <label for="symptoms">S√≠ntomas (separados por comas)</label>
              <input type="text" id="symptoms" class="form-control" placeholder="cefalea, fiebre, rigidez de nuca...">
            </div>
            <div class="form-group">
              <label for="lab-results">Resultados de Laboratorio</label>
              <textarea id="lab-results" class="form-control" rows="3" placeholder="LCR: turbio, neutr√≥filos elevados..."></textarea>
            </div>
            <button class="btn btn-primary" onclick="runDiagnosticAI()">
              <span class="material-symbols-outlined">auto_fix_high</span>Analizar Diagn√≥stico
            </button>
            <div id="diagnostic-results" style="margin-top: 20px;">
              <!-- Resultados del diagn√≥stico -->
            </div>
          </div>
        </div>

        <div id="vitals-tab" class="tab-content">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title"><span class="material-symbols-outlined">monitor_heart</span>Signos Vitales</h3>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="temperature">Temperatura (¬∞C)</label>
                <input type="number" id="temperature" class="form-control" step="0.1" placeholder="36.5">
              </div>
              <div class="form-group">
                <label for="pa">Presi√≥n Arterial</label>
                <input type="text" id="pa" class="form-control" placeholder="120/80">
              </div>
              <div class="form-group">
                <label for="fc">Frecuencia Card√≠aca</label>
                <input type="number" id="fc" class="form-control" placeholder="75">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="fr">Frecuencia Respiratoria</label>
                <input type="number" id="fr" class="form-control" placeholder="16">
              </div>
              <div class="form-group">
                <label for="spo2">Saturaci√≥n O2 (%)</label>
                <input type="number" id="spo2" class="form-control" placeholder="98">
              </div>
              <div class="form-group">
                <label for="weight">Peso (kg)</label>
                <input type="number" id="weight" class="form-control" step="0.1" placeholder="70">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="height">Talla (cm)</label>
                <input type="number" id="height" class="form-control" placeholder="170">
              </div>
              <div class="form-group">
                <label for="imc">IMC</label>
                <input type="text" id="imc" class="form-control" readonly>
              </div>
            </div>
            <button class="btn btn-primary" onclick="saveVitalSigns()">
              <span class="material-symbols-outlined">save</span>Guardar Signos Vitales
            </button>
          </div>
        </div>

        <div id="prescriptions-tab" class="tab-content">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title"><span class="material-symbols-outlined">prescriptions</span>Recetas</h3>
            </div>
            <div id="medication-entries">
              <div class="medication-entry">
                <div class="form-row">
                  <div class="form-group flex-grow">
                    <label for="medication-1">Medicamento</label>
                    <input type="text" id="medication-1" class="form-control medication-name" placeholder="Nombre del medicamento">
                  </div>
                  <div class="form-group">
                    <label for="dose-1">Dosis</label>
                    <input type="text" id="dose-1" class="form-control" placeholder="10mg">
                  </div>
                  <div class="form-group">
                    <label for="frequency-1">Frecuencia</label>
                    <select id="frequency-1" class="form-control">
                      <option value="once">1 vez al d√≠a</option>
                      <option value="twice">2 veces al d√≠a</option>
                      <option value="thrice">3 veces al d√≠a</option>
                      <option value="four-times">4 veces al d√≠a</option>
                      <option value="as-needed">Seg√∫n necesidad</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="duration-1">Duraci√≥n</label>
                    <input type="text" id="duration-1" class="form-control" placeholder="7 d√≠as">
                  </div>
                </div>
                <div class="form-group">
                  <label for="instructions-1">Instrucciones</label>
                  <input type="text" id="instructions-1" class="form-control" placeholder="Tomar con alimentos...">
                </div>
              </div>
            </div>
            <button class="btn btn-secondary" id="add-medication" onclick="addMedicationEntry()">
              <span class="material-symbols-outlined">add</span>Agregar Medicamento
            </button>
            <button class="btn btn-primary" style="margin-top: 10px;" onclick="checkInteractions()">
              <span class="material-symbols-outlined">warning</span>Verificar Interacciones
            </button>
            <div id="interactions-warning" style="margin-top: 15px; display: none;">
              <div class="alert-card">
                <span class="material-symbols-outlined alert-icon">warning</span>
                <div>
                  <strong>Interacciones Detectadas:</strong>
                  <ul id="interactions-list"></ul>
                </div>
              </div>
            </div>
            <button class="btn btn-primary" style="margin-top: 15px;" onclick="savePrescription()">
              <span class="material-symbols-outlined">save</span>Guardar Receta
            </button>
          </div>
        </div>

        <div id="orders-tab" class="tab-content">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title"><span class="material-symbols-outlined">receipt_long</span>√ìrdenes M√©dicas</h3>
            </div>
            <div class="form-group">
              <label for="order-type">Tipo de Orden</label>
              <select id="order-type" class="form-control" onchange="updateOrderOptions()">
                <option value="">Seleccionar tipo...</option>
                <option value="laboratory">Laboratorio</option>
                <option value="imaging">Imagenolog√≠a</option>
                <option value="consultation">Interconsulta</option>
              </select>
            </div>
            <div class="form-group" id="order-options-container">
              <!-- Opciones din√°micas seg√∫n el tipo -->
            </div>
            <button class="btn btn-primary" onclick="createMedicalOrder()">
              <span class="material-symbols-outlined">add</span>Crear Orden
            </button>
            <div id="orders-list" style="margin-top: 20px;">
              <!-- Lista de √≥rdenes -->
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Citas -->
    <section id="appointments" class="page">
      <div class="page-header">
        <h2><span class="material-symbols-outlined">event</span>Gesti√≥n de Citas</h2>
        <button class="btn btn-secondary" onclick="navigateTo('dashboard')">
          <span class="material-symbols-outlined">arrow_back</span>Volver
        </button>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><span class="material-symbols-outlined">event_available</span>Nueva Cita</h3>
        </div>
        <div class="form-row">
          <div class="form-group flex-grow">
            <label for="appointment-patient">Paciente</label>
            <select id="appointment-patient" class="form-control">
              <option value="">Seleccionar paciente...</option>
              <!-- Se llenar√° con JavaScript -->
            </select>
          </div>
          <div class="form-group">
            <label for="appointment-date">Fecha</label>
            <input type="date" id="appointment-date" class="form-control">
          </div>
          <div class="form-group">
            <label for="appointment-time">Hora</label>
            <input type="time" id="appointment-time" class="form-control">
          </div>
        </div>
        <div class="form-group">
          <label for="appointment-reason">Motivo</label>
          <input type="text" id="appointment-reason" class="form-control" placeholder="Consulta de seguimiento...">
        </div>
        <button class="btn btn-primary" onclick="createAppointment()">
          <span class="material-symbols-outlined">add</span>Programar Cita
        </button>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><span class="material-symbols-outlined">calendar_month</span>Calendario de Citas</h3>
        </div>
        <div class="calendar">
          <div class="calendar-header">
            <div>Lun</div>
            <div>Mar</div>
            <div>Mi√©</div>
            <div>Jue</div>
            <div>Vie</div>
            <div>S√°b</div>
            <div>Dom</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">1</div>
            <div class="appointment">10:00 - Mar√≠a L√≥pez</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">2</div>
            <div class="appointment">14:00 - Carlos Ruiz</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">3</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">4</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">5</div>
            <div class="appointment">09:00 - Ana Garc√≠a</div>
            <div class="appointment">15:00 - Luis P√©rez</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">6</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">7</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">8</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">9</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">10</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">11</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">12</div>
            <div class="appointment">11:00 - Roberto S√°nchez</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">13</div>
          </div>
          <div class="calendar-day">
            <div class="day-number">14</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><span class="material-symbols-outlined">groups</span>Sala de Espera</h3>
        </div>
        <div class="waiting-room">
          <table>
            <thead>
              <tr>
                <th>Paciente</th>
                <th>M√©dico</th>
                <th>Hora de llegada</th>
                <th>Tiempo de espera</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Mar√≠a L√≥pez</td>
                <td>Dr. P√©rez</td>
                <td>10:15</td>
                <td class="waiting-time high">45 min</td>
              </tr>
              <tr>
                <td>Carlos Ruiz</td>
                <td>Dr. Fern√°ndez</td>
                <td>10:30</td>
                <td class="waiting-time">30 min</td>
              </tr>
              <tr>
                <td>Ana Garc√≠a</td>
                <td>Dr. P√©rez</td>
                <td>10:45</td>
                <td class="waiting-time">15 min</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Farmacia -->
    <section id="pharmacy" class="page">
      <div class="page-header">
        <h2><span class="material-symbols-outlined">local_pharmacy</span>Farmacia</h2>
        <button class="btn btn-secondary" onclick="navigateTo('dashboard')">
          <span class="material-symbols-outlined">arrow_back</span>Volver
        </button>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><span class="material-symbols-outlined">inventory</span>Stock de Medicamentos</h3>
        </div>
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="background-color: #f5f5f5; border-bottom: 2px solid #eee;">
              <th style="padding: 12px; text-align: left;">Medicamento</th>
              <th style="padding: 12px; text-align: left;">Laboratorio</th>
              <th style="padding: 12px; text-align: left;">Cantidad</th>
              <th style="padding: 12px; text-align: left;">Estado</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Metformina</td>
              <td>Gen√©rico</td>
              <td>120</td>
              <td><span style="color: green; font-weight: 600;">Normal</span></td>
            </tr>
            <tr>
              <td>Losart√°n</td>
              <td>MSD</td>
              <td>30</td>
              <td><span style="color: orange; font-weight: 600;">Bajo</span></td>
            </tr>
            <tr>
              <td>Aspirina</td>
              <td>Bayer</td>
              <td>8</td>
              <td><span style="color: red; font-weight: 600;">Cr√≠tico</span></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title"><span class="material-symbols-outlined">receipt_long</span>√ìrdenes de Laboratorio</h3>
        </div>
        <div id="lab-orders-list">
          <div class="alert-card info">
            <span class="material-symbols-outlined alert-icon">info</span>
            <div>
              <strong>√ìrdenes Pendientes:</strong> Hemograma, Creatinina, Perfil Lip√≠dico
            </div>
          </div>
          <div class="alert-card success">
            <span class="material-symbols-outlined alert-icon">check_circle</span>
            <div>
              <strong>Resultados Disponibles:</strong> Glucosa en Ayunas - 98 mg/dL
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal de b√∫squeda de pacientes -->
  <div id="modal-overlay" class="modal-overlay">
    <div class="modal">
      <div class="modal-header">
        <h2><span class="material-symbols-outlined">search</span>Buscar Paciente</h2>
        <button class="modal-close-btn" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <input type="text" id="modal-search" class="form-control" placeholder="Buscar por nombre..." oninput="filterModalPatients()">
        </div>
        <div id="modal-patient-list">
          <!-- Lista de pacientes en el modal -->
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Contenedor de notificaciones -->
  <div class="notification-container" id="notification-container">
    <!-- Las notificaciones se agregar√°n aqu√≠ din√°micamente -->
  </div>

  <script>
    // Estado de la aplicaci√≥n
    const APP_STATE = {
      activePatientId: null,
      currentSection: 'dashboard',
      theme: 'light',
      patients: [
        { id: 1, nombre: "Mar√≠a L√≥pez", edad: 45, diagnosticoPrincipal: "Meningitis Bacteriana", especialidad: "Neurolog√≠a", riesgoCardiovascular: "alto" },
        { id: 2, nombre: "Carlos Mart√≠nez", edad: 38, diagnosticoPrincipal: "Diabetes Mellitus Tipo 2", especialidad: "Endocrinolog√≠a", riesgoCardiovascular: "moderado" },
        { id: 3, nombre: "Ana Garc√≠a", edad: 62, diagnosticoPrincipal: "VIH", especialidad: "Infectolog√≠a", riesgoCardiovascular: "bajo" },
        { id: 4, nombre: "Roberto S√°nchez", edad: 67, diagnosticoPrincipal: "Insuficiencia Card√≠aca", especialidad: "Cardiolog√≠a", riesgoCardiovascular: "alto" }
      ],
      appointments: [
        { id: 1, pacienteId: 1, fecha: "2025-04-12", hora: "10:00", motivo: "Consulta de seguimiento", estado: "confirmada" },
        { id: 2, pacienteId: 2, fecha: "2025-04-12", hora: "14:00", motivo: "Control de glucemia", estado: "pendiente" },
        { id: 3, pacienteId: 4, fecha: "2025-04-12", hora: "11:00", motivo: "Evaluaci√≥n cardiol√≥gica", estado: "confirmada" }
      ],
      medicalOrders: [],
      medications: [
        { id: "dr-001", nombre: "Metformina", laboratorio: "Gen√©rico", contraindicaciones: ["Embarazo", "Insuficiencia renal"], interacciones: {
          "Contraste yodado": { severidad: "fatal", descripcion: "Riesgo muy alto de acidosis l√°ctica." },
          "Alcohol": { severidad: "moderada", descripcion: "Aumenta el riesgo de acidosis l√°ctica." }
        }, efectosSecundarios: ["Diarrea", "N√°useas", "Dolor abdominal"] },
        { id: "dr-002", nombre: "Losart√°n", laboratorio: "MSD", contraindicaciones: ["Embarazo", "Hipersensibilidad"], interacciones: {
          "Aspirina": { severidad: "leve", descripcion: "Puede aumentar levemente el riesgo de sangrado." },
          "Furosemida": { severidad: "moderada", descripcion: "Puede potenciar el efecto hipotensor." }
        }, efectosSecundarios: ["Hipotensi√≥n", "Hiperkalemia", "Tos"] },
        { id: "dr-003", nombre: "Aspirina", laboratorio: "Bayer", contraindicaciones: ["Hemorragia activa", "√ölcera p√©ptica"], interacciones: {
          "Losart√°n": { severidad: "leve", descripcion: "Puede aumentar levemente el riesgo de sangrado." },
          "Warfarina": { severidad: "fatal", descripcion: "Riesgo muy alto de hemorragia grave." }
        }, efectosSecundarios: ["Irritaci√≥n g√°strica", "Sangrado"] }
      ]
    };

    // Funciones de utilidad
    function navigateTo(section) {
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      document.getElementById(section).classList.add('active');
      
      document.querySelectorAll('nav ul li a').forEach(link => {
        link.classList.remove('active');
      });
      document.querySelector(`nav ul li a[onclick="navigateTo('${section}')"]`).classList.add('active');
      
      APP_STATE.currentSection = section;
    }

    function switchTab(tabId) {
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      document.querySelector(`.tab[onclick="switchTab('${tabId}')"]`).classList.add('active');
      document.getElementById(`${tabId}-tab`).classList.add('active');
    }

    function toggleTheme() {
      document.body.classList.toggle('theme-dark');
      const isDark = document.body.classList.contains('theme-dark');
      APP_STATE.theme = isDark ? 'dark' : 'light';
      
      const themeButton = document.querySelector('nav ul li a[onclick="toggleTheme()"] .material-symbols-outlined');
      if (themeButton) {
        themeButton.textContent = isDark ? 'light_mode' : 'dark_mode';
      }
    }

    function showNotification(message, type = 'info') {
      const container = document.getElementById('notification-container');
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.innerHTML = `
        <span class="material-symbols-outlined">
          ${type === 'success' ? 'check_circle' : type === 'error' ? 'error' : type === 'warning' ? 'warning' : 'info'}
        </span>
        ${message}
      `;
      
      container.appendChild(notification);
      
      setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => {
          container.removeChild(notification);
        }, 300);
      }, 5000);
    }

    // Inicializaci√≥n
    function initApp() {
      // Fecha actual
      const now = new Date();
      const options = { year: 'numeric', month: 'long', day: 'numeric' };
      document.getElementById('current-date').textContent = now.toLocaleDateString('es-ES', options);
      
      // Llenar lista de pacientes
      updatePatientList();
      
      // Llenar lista de pacientes en el modal
      updateModalPatientList();
      
      // Llenar select de pacientes en citas
      updateAppointmentPatientSelect();
      
      // Actualizar pr√≥ximas citas
      updateUpcomingAppointments();
      
      // Actualizar opciones de IMC
      setupVitalSigns();
    }

    function updatePatientList() {
      const tbody = document.getElementById('patient-list-body');
      tbody.innerHTML = '';
      
      APP_STATE.patients.forEach(patient => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${patient.nombre}</td>
          <td>${patient.edad}</td>
          <td>${patient.diagnosticoPrincipal}</td>
          <td>
            <button class="btn btn-primary" onclick="selectPatient(${patient.id})">
              <span class="material-symbols-outlined">edit</span>Atender
            </button>
          </td>
        `;
        tbody.appendChild(row);
      });
    }

    function updateModalPatientList() {
      const container = document.getElementById('modal-patient-list');
      container.innerHTML = '';
      
      APP_STATE.patients.forEach(patient => {
        const div = document.createElement('div');
        div.className = 'patient-card';
        div.style = 'padding: 15px; border: 1px solid #eee; border-radius: var(--border-radius); margin-bottom: 10px; background-color: white; cursor: pointer;';
        div.innerHTML = `
          <h3 style="margin: 0;">${patient.nombre}</h3>
          <p style="margin: 5px 0;">Edad: ${patient.edad} | Diagn√≥stico: ${patient.diagnosticoPrincipal}</p>
        `;
        div.onclick = function() {
          selectPatient(patient.id);
          closeModal();
        };
        container.appendChild(div);
      });
    }

    function filterModalPatients() {
      const query = document.getElementById('modal-search').value.toLowerCase();
      const container = document.getElementById('modal-patient-list');
      container.innerHTML = '';
      
      const filtered = APP_STATE.patients.filter(patient => 
        patient.nombre.toLowerCase().includes(query)
      );
      
      if (filtered.length === 0) {
        container.innerHTML = '<p>No se encontraron pacientes.</p>';
        return;
      }
      
      filtered.forEach(patient => {
        const div = document.createElement('div');
        div.className = 'patient-card';
        div.style = 'padding: 15px; border: 1px solid #eee; border-radius: var(--border-radius); margin-bottom: 10px; background-color: white; cursor: pointer;';
        div.innerHTML = `
          <h3 style="margin: 0;">${patient.nombre}</h3>
          <p style="margin: 5px 0;">Edad: ${patient.edad} | Diagn√≥stico: ${patient.diagnosticoPrincipal}</p>
        `;
        div.onclick = function() {
          selectPatient(patient.id);
          closeModal();
        };
        container.appendChild(div);
      });
    }

    function updateAppointmentPatientSelect() {
      const select = document.getElementById('appointment-patient');
      select.innerHTML = '<option value="">Seleccionar paciente...</option>';
      
      APP_STATE.patients.forEach(patient => {
        const option = document.createElement('option');
        option.value = patient.id;
        option.textContent = patient.nombre;
        select.appendChild(option);
      });
    }

    function updateUpcomingAppointments() {
      const container = document.getElementById('upcoming-appointments');
      container.innerHTML = '';
      
      const today = new Date().toISOString().split('T')[0];
      const upcoming = APP_STATE.appointments.filter(appt => appt.fecha >= today);
      
      if (upcoming.length === 0) {
        container.innerHTML = '<p>No hay citas programadas.</p>';
        return;
      }
      
      const ul = document.createElement('ul');
      ul.style = 'list-style: none; padding: 0;';
      
      upcoming.forEach(appt => {
        const patient = APP_STATE.patients.find(p => p.id === appt.pacienteId);
        const li = document.createElement('li');
        li.style = 'padding: 10px; border-bottom: 1px solid #eee; margin-bottom: 5px;';
        li.innerHTML = `
          <strong>${appt.hora}</strong> - ${patient ? patient.nombre : 'Paciente desconocido'} (${appt.motivo})
        `;
        ul.appendChild(li);
      });
      
      container.appendChild(ul);
    }

    function selectPatient(patientId) {
      const patient = APP_STATE.patients.find(p => p.id === patientId);
      if (!patient) return;
      
      APP_STATE.activePatientId = patientId;
      
      // Mostrar informaci√≥n del paciente activo
      const patientInfo = document.getElementById('active-patient-info');
      patientInfo.style.display = 'block';
      document.getElementById('active-patient-name').textContent = patient.nombre;
      document.getElementById('active-patient-age').textContent = `${patient.edad} a√±os`;
      document.getElementById('active-patient-diagnosis').textContent = patient.diagnosticoPrincipal;
      
      // Navegar al consultorio
      navigateTo('consultorio');
      
      showNotification(`Paciente ${patient.nombre} seleccionado para consulta.`);
    }

    function openPatientSearchModal() {
      const modal = document.getElementById('modal-overlay');
      modal.classList.add('active');
      document.getElementById('modal-search').value = '';
      filterModalPatients();
    }

    function closeModal() {
      const modal = document.getElementById('modal-overlay');
      modal.classList.remove('active');
    }

    // Funcionalidades del consultorio
    function runDiagnosticAI() {
      const symptomsInput = document.getElementById('symptoms');
      const labResultsInput = document.getElementById('lab-results');
      
      if (!symptomsInput || !labResultsInput) return;
      
      const symptoms = symptomsInput.value.toLowerCase().split(',').map(s => s.trim()).filter(s => s);
      const labResults = labResultsInput.value.toLowerCase();
      
      if (symptoms.length === 0) {
        showNotification('Por favor, ingrese al menos un s√≠ntoma.', 'warning');
        return;
      }
      
      // Simulaci√≥n de IA de diagn√≥stico diferencial
      const resultsDiv = document.getElementById('diagnostic-results');
      resultsDiv.innerHTML = '<p>Analizando s√≠ntomas y resultados...</p>';
      
      // Simular proceso de an√°lisis
      setTimeout(() => {
        let results = [];
        
        if (symptoms.includes('cefalea') && symptoms.includes('fiebre') && symptoms.includes('rigidez de nuca')) {
          results.push({
            diagnostico: 'Meningitis Bacteriana',
            nivelSospecha: 92,
            recomendaciones: [
              'Realizar punci√≥n lumbar de urgencia',
              'Iniciar tratamiento emp√≠rico con ceftriaxona + vancomicina',
              'Solicitar hemograma, funci√≥n renal y cultivos de sangre'
            ]
          });
        }
        
        if (symptoms.includes('dolor tor√°cico') && symptoms.includes('disnea')) {
          results.push({
            diagnostico: 'S√≠ndrome Coronario Agudo',
            nivelSospecha: 85,
            recomendaciones: [
              'Realizar ECG de urgencia',
              'Marcadores de da√±o mioc√°rdico (troponina)',
              'Considerar angioplastia primaria si STEMI'
            ]
          });
        }
        
        if (symptoms.includes('poliuria') && symptoms.includes('polidipsia')) {
          results.push({
            diagnostico: 'Diabetes Mellitus Tipo 2',
            nivelSospecha: 78,
            recomendaciones: [
              'Glucosa en ayunas y HbA1c',
              'Perfil lip√≠dico',
              'Evaluaci√≥n de complicaciones cr√≥nicas'
            ]
          });
        }
        
        if (results.length === 0) {
          results.push({
            diagnostico: 'S√≠ndrome Febril Inespec√≠fico',
            nivelSospecha: 65,
            recomendaciones: [
              'Hemograma completo',
              'PCR o VSG',
              'Cultivos seg√∫n sospecha cl√≠nica'
            ]
          });
        }
        
        // Mostrar resultados
        resultsDiv.innerHTML = '';
        results.forEach(result => {
          const resultDiv = document.createElement('div');
          resultDiv.className = 'diagnostic-result';
          resultDiv.innerHTML = `
            <h4>${result.diagnostico}</h4>
            <small>Nivel de sospecha</small>
            <div class="progress-bar">
              <div class="progress" style="width: ${result.nivelSospecha}%"></div>
            </div>
            <small>${result.nivelSospecha}% de probabilidad</small>
            <div class="recommendation">
              <strong>Recomendaciones:</strong>
              <ul>${result.recomendaciones.map(rec => `<li>${rec}</li>`).join('')}</ul>
            </div>
          `;
          resultsDiv.appendChild(resultDiv);
        });
        
        showNotification('An√°lisis de diagn√≥stico completado.');
      }, 1500);
    }

    function setupVitalSigns() {
      const weightInput = document.getElementById('weight');
      const heightInput = document.getElementById('height');
      const imcOutput = document.getElementById('imc');
      
      function updateIMC() {
        const weight = parseFloat(weightInput?.value);
        const height = parseFloat(heightInput?.value);
        if (weight > 0 && height > 0) {
          const heightInMeters = height / 100;
          const imc = weight / (heightInMeters * heightInMeters);
          if (imcOutput) imcOutput.value = imc.toFixed(2);
        } else {
          if (imcOutput) imcOutput.value = '';
        }
      }
      
      weightInput?.addEventListener('input', updateIMC);
      heightInput?.addEventListener('input', updateIMC);
    }

    function saveVitalSigns() {
      const temperature = document.getElementById('temperature');
      const pa = document.getElementById('pa');
      const fc = document.getElementById('fc');
      const fr = document.getElementById('fr');
      const spo2 = document.getElementById('spo2');
      const weight = document.getElementById('weight');
      const height = document.getElementById('height');
      
      if (!temperature || !pa || !fc || !fr || !spo2 || !weight || !height) {
        showNotification('Error al guardar signos vitales.', 'error');
        return;
      }
      
      if (!APP_STATE.activePatientId) {
        showNotification('Por favor, seleccione un paciente primero.', 'warning');
        return;
      }
      
      if (!temperature.value || !pa.value || !fc.value || !fr.value || !spo2.value || !weight.value || !height.value) {
        showNotification('Por favor, complete todos los campos de signos vitales.', 'warning');
        return;
      }
      
      // Simular guardado
      showNotification('Signos vitales guardados correctamente.', 'success');
      
      // Limpiar formulario
      temperature.value = '';
      pa.value = '';
      fc.value = '';
      fr.value = '';
      spo2.value = '';
      weight.value = '';
      height.value = '';
    }

    function addMedicationEntry() {
      const container = document.getElementById('medication-entries');
      const entryCount = container.children.length + 1;
      
      const entry = document.createElement('div');
      entry.className = 'medication-entry';
      entry.innerHTML = `
        <div class="form-row">
          <div class="form-group flex-grow">
            <label for="medication-${entryCount}">Medicamento</label>
            <input type="text" id="medication-${entryCount}" class="form-control medication-name" placeholder="Nombre del medicamento">
          </div>
          <div class="form-group">
            <label for="dose-${entryCount}">Dosis</label>
            <input type="text" id="dose-${entryCount}" class="form-control" placeholder="10mg">
          </div>
          <div class="form-group">
            <label for="frequency-${entryCount}">Frecuencia</label>
            <select id="frequency-${entryCount}" class="form-control">
              <option value="once">1 vez al d√≠a</option>
              <option value="twice">2 veces al d√≠a</option>
              <option value="thrice">3 veces al d√≠a</option>
              <option value="four-times">4 veces al d√≠a</option>
              <option value="as-needed">Seg√∫n necesidad</option>
            </select>
          </div>
          <div class="form-group">
            <label for="duration-${entryCount}">Duraci√≥n</label>
            <input type="text" id="duration-${entryCount}" class="form-control" placeholder="7 d√≠as">
          </div>
        </div>
        <div class="form-group">
          <label for="instructions-${entryCount}">Instrucciones</label>
          <input type="text" id="instructions-${entryCount}" class="form-control" placeholder="Tomar con alimentos...">
        </div>
        <button class="btn btn-danger" style="margin-top: 10px;" onclick="this.parentElement.remove()">
          <span class="material-symbols-outlined">delete</span>Eliminar
        </button>
      `;
      
      container.appendChild(entry);
    }

    function checkInteractions() {
      const medicationEntries = document.querySelectorAll('.medication-entry');
      const currentMedications = [];
      
      medicationEntries.forEach(entry => {
        const medNameInput = entry.querySelector('.medication-name');
        if (medNameInput && medNameInput.value) {
          currentMedications.push(medNameInput.value.trim());
        }
      });
      
      if (currentMedications.length < 2) {
        showNotification('Se necesitan al menos 2 medicamentos para verificar interacciones.', 'warning');
        return;
      }
      
      const warnings = new Set();
      
      // Verificar interacciones directas
      for (let i = 0; i < currentMedications.length; i++) {
        const med1Name = currentMedications[i];
        const med1Data = APP_STATE.medications.find(med => med.nombre.toLowerCase() === med1Name.toLowerCase());
        
        if (med1Data) {
          for (let j = i + 1; j < currentMedications.length; j++) {
            const med2Name = currentMedications[j];
            
            if (med1Data.interacciones[med2Name]) {
              const interaction = med1Data.interacciones[med2Name];
              warnings.add(`${med1Name} - ${med2Name}: ${interaction.descripcion} (<span class="severity-${interaction.severidad}">${interaction.severidad}</span>)`);
            }
            
            // Verificar la interacci√≥n inversa
            const med2Data = APP_STATE.medications.find(med => med.nombre.toLowerCase() === med2Name.toLowerCase());
            if (med2Data && med2Data.interacciones[med1Name]) {
              const interaction = med2Data.interacciones[med1Name];
              warnings.add(`${med2Name} - ${med1Name}: ${interaction.descripcion} (<span class="severity-${interaction.severidad}">${interaction.severidad}</span>)`);
            }
          }
        }
      }
      
      // Mostrar advertencias
      const warningDiv = document.getElementById('interactions-warning');
      const warningList = document.getElementById('interactions-list');
      
      if (warnings.size > 0) {
        warningList.innerHTML = '';
        warnings.forEach(warning => {
          const li = document.createElement('li');
          li.innerHTML = warning;
          warningList.appendChild(li);
        });
        warningDiv.style.display = 'block';
        showNotification(`${warnings.size} interacciones medicamentosas detectadas.`, 'warning');
      } else {
        warningDiv.style.display = 'none';
        showNotification('No se detectaron interacciones medicamentosas.', 'success');
      }
    }

    function savePrescription() {
      if (!APP_STATE.activePatientId) {
        showNotification('Por favor, seleccione un paciente primero.', 'warning');
        return;
      }
      
      const medicationEntries = document.querySelectorAll('.medication-entry');
      const prescriptions = [];
      
      let valid = true;
      medicationEntries.forEach(entry => {
        const medName = entry.querySelector('.medication-name').value;
        const dose = entry.querySelector('#dose-1')?.value;
        const frequency = entry.querySelector('#frequency-1')?.value;
        
        if (medName && dose && frequency) {
          prescriptions.push({ medName, dose, frequency });
        } else {
          valid = false;
        }
      });
      
      if (!valid) {
        showNotification('Por favor, complete todos los campos de la receta.', 'warning');
        return;
      }
      
      if (prescriptions.length === 0) {
        showNotification('No hay medicamentos en la receta.', 'warning');
        return;
      }
      
      // Simular guardado
      showNotification('Receta guardada correctamente.', 'success');
      
      // Limpiar formulario
      document.getElementById('medication-entries').innerHTML = '';
      addMedicationEntry();
    }

    function updateOrderOptions() {
      const orderType = document.getElementById('order-type').value;
      const container = document.getElementById('order-options-container');
      container.innerHTML = '';
      
      if (!orderType) return;
      
      const select = document.createElement('select');
      select.className = 'form-control';
      select.id = 'order-option';
      select.innerHTML = '<option value="">Seleccionar opci√≥n...</option>';
      
      if (orderType === 'laboratory') {
        select.innerHTML += `
          <option value="hemograma">Hemograma Completo</option>
          <option value="funcion-renales">Funci√≥n Renales</option>
          <option value="perfil-lipidico">Perfil Lip√≠dico</option>
          <option value="glucosa">Glucosa en Ayunas</option>
        `;
      } else if (orderType === 'imaging') {
        select.innerHTML += `
          <option value="rx-torax">Rayos X de T√≥rax</option>
          <option value="tac-cerebral">TAC Cerebral</option>
          <option value="rm-columna">RM de Columna</option>
          <option value="ecografia-abdominal">Ecograf√≠a Abdominal</option>
        `;
      } else if (orderType === 'consultation') {
        select.innerHTML += `
          <option value="neurologia">Neurolog√≠a</option>
          <option value="cardiologia">Cardiolog√≠a</option>
          <option value="endocrinologia">Endocrinolog√≠a</option>
          <option value="infectologia">Infectolog√≠a</option>
        `;
      }
      
      container.appendChild(select);
    }

    function createMedicalOrder() {
      const orderType = document.getElementById('order-type').value;
      const orderOption = document.getElementById('order-option')?.value;
      
      if (!orderType || !orderOption) {
        showNotification('Por favor, seleccione tipo y opci√≥n de orden.', 'warning');
        return;
      }
      
      if (!APP_STATE.activePatientId) {
        showNotification('Por favor, seleccione un paciente primero.', 'warning');
        return;
      }
      
      const patient = APP_STATE.patients.find(p => p.id === APP_STATE.activePatientId);
      
      const order = {
        id: 'ord-' + Date.now(),
        type: orderType,
        option: orderOption,
        patientId: APP_STATE.activePatientId,
        patientName: patient.nombre,
        date: new Date().toISOString().split('T')[0],
        status: 'pendiente'
      };
      
      APP_STATE.medicalOrders.push(order);
      
      // Mostrar en lista
      const ordersList = document.getElementById('orders-list');
      if (!ordersList.querySelector('.alert-card')) {
        ordersList.innerHTML = '';
      }
      
      const alert = document.createElement('div');
      alert.className = 'alert-card info';
      alert.innerHTML = `
        <span class="material-symbols-outlined alert-icon">info</span>
        <div>
          <strong>Orden Creada:</strong> ${order.option} para ${patient.nombre}
        </div>
      `;
      ordersList.appendChild(alert);
      
      showNotification('Orden m√©dica creada correctamente.');
      
      // Resetear formulario
      document.getElementById('order-type').value = '';
      document.getElementById('order-options-container').innerHTML = '';
    }

    function createAppointment() {
      const patientId = document.getElementById('appointment-patient').value;
      const date = document.getElementById('appointment-date').value;
      const time = document.getElementById('appointment-time').value;
      const reason = document.getElementById('appointment-reason').value;
      
      if (!patientId || !date || !time || !reason) {
        showNotification('Por favor, complete todos los campos.', 'warning');
        return;
      }
      
      const appointment = {
        id: 'app-' + Date.now(),
        pacienteId: parseInt(patientId),
        fecha: date,
        hora: time,
        motivo: reason,
        estado: 'confirmada'
      };
      
      APP_STATE.appointments.push(appointment);
      
      // Resetear formulario
      document.getElementById('appointment-patient').value = '';
      document.getElementById('appointment-date').value = '';
      document.getElementById('appointment-time').value = '';
      document.getElementById('appointment-reason').value = '';
      
      // Actualizar listas
      updateUpcomingAppointments();
      
      showNotification('Cita programada correctamente.');
    }

    // Inicializar la aplicaci√≥n
    document.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>
```
